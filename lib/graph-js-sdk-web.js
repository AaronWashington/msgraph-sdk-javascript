(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){window.MicrosoftGraph=require("./lib/src/index.js")},{"./lib/src/index.js":14}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Constants_1=require("./Constants");var GraphRequest_1=require("./GraphRequest");var HTTPClientFactory_1=require("./HTTPClientFactory");var HTTPClient_1=require("./HTTPClient");var Client=function(){function Client(){this.config={baseUrl:Constants_1.GRAPH_BASE_URL,debugLogging:false,defaultVersion:Constants_1.GRAPH_API_VERSION}}Client.init=function(options){var client=new Client;for(var key in options){client.config[key]=options[key]}var httpClient;if(options.authProvider!==undefined){httpClient=HTTPClientFactory_1.HTTPClientFactory.createWithAuthenticationProvider(options.authProvider)}else if(options.middleware!==undefined){httpClient=new HTTPClient_1.HTTPClient(options.middleware)}else{var error=new Error;error.name="InvalidMiddlewareChain";error.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain";throw error}client.httpClient=httpClient;return client};Client.prototype.api=function(path){var self=this;return new GraphRequest_1.GraphRequest(self.httpClient,self.config,path)};return Client}();exports.Client=Client},{"./Constants":3,"./GraphRequest":4,"./HTTPClient":6,"./HTTPClientFactory":7}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GRAPH_API_VERSION="v1.0";exports.GRAPH_BASE_URL="https://graph.microsoft.com/";exports.PACKAGE_VERSION="1.3.0"},{}],4:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var Constants_1=require("./Constants");var GraphRequestUtil_1=require("./GraphRequestUtil");var RequestMethod_1=require("./RequestMethod");var ResponseType_1=require("./ResponseType");var GraphRequest=function(){function GraphRequest(httpClient,config,path){var _this=this;this.parsePath=function(path){var self=_this;if(path.indexOf("https://")!==-1){path=path.replace("https://","");var endOfHostStrPos=path.indexOf("/");self.urlComponents.host="https://"+path.substring(0,endOfHostStrPos);path=path.substring(endOfHostStrPos+1,path.length);var endOfVersionStrPos=path.indexOf("/");self.urlComponents.version=path.substring(0,endOfVersionStrPos);path=path.substring(endOfVersionStrPos+1,path.length)}if(path.charAt(0)==="/"){path=path.substr(1)}var queryStrPos=path.indexOf("?");if(queryStrPos===-1){self.urlComponents.path=path}else{self.urlComponents.path=path.substr(0,queryStrPos);var queryParams=path.substring(queryStrPos+1,path.length).split("&");for(var _i=0,queryParams_1=queryParams;_i<queryParams_1.length;_i++){var queryParam=queryParams_1[_i];var queryParams_2=queryParam.split("="),key=queryParams_2[0],value=queryParams_2[1];if(GraphRequestUtil_1.oDataQueryNames.indexOf(key)){self.urlComponents.oDataQueryParams[key]=value}else{self.urlComponents.otherURLQueryParams[key]=value}}}};var self=this;self.httpClient=httpClient;self.config=config;self.urlComponents={host:self.config.baseUrl,version:self.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{}};self._options={};self._headers={};self.parsePath(path)}GraphRequest.prototype.header=function(headerKey,headerValue){var self=this;self._headers[headerKey]=headerValue;return self};GraphRequest.prototype.headers=function(headers){var self=this;for(var key in headers){self._headers[key]=headers[key]}return self};GraphRequest.prototype.option=function(key,value){var self=this;self._options[key]=value;return self};GraphRequest.prototype.options=function(options){var self=this;for(var key in options){self._options[key]=options[key]}return self};GraphRequest.prototype.version=function(version){var self=this;self.urlComponents.version=version;return self};GraphRequest.prototype.responseType=function(responseType){var self=this;self._responseType=responseType;return self};GraphRequest.prototype.addCsvQueryParameter=function(propertyName,propertyValue,additionalProperties){this.urlComponents.oDataQueryParams[propertyName]=this.urlComponents.oDataQueryParams[propertyName]?this.urlComponents.oDataQueryParams[propertyName]+",":"";var allValues=[];if(additionalProperties.length>1&&typeof propertyValue==="string"){allValues=Array.prototype.slice.call(additionalProperties)}else if(typeof propertyValue==="string"){allValues.push(propertyValue)}else{allValues=allValues.concat(propertyValue)}this.urlComponents.oDataQueryParams[propertyName]+=allValues.join(",")};GraphRequest.prototype.select=function(properties){var self=this;self.addCsvQueryParameter("$select",properties,arguments);return self};GraphRequest.prototype.expand=function(properties){var self=this;self.addCsvQueryParameter("$expand",properties,arguments);return self};GraphRequest.prototype.orderby=function(properties){var self=this;self.addCsvQueryParameter("$orderby",properties,arguments);return self};GraphRequest.prototype.filter=function(filterStr){var self=this;self.urlComponents.oDataQueryParams["$filter"]=filterStr;return self};GraphRequest.prototype.top=function(n){var self=this;self.urlComponents.oDataQueryParams["$top"]=n;return self};GraphRequest.prototype.skip=function(n){var self=this;self.urlComponents.oDataQueryParams["$skip"]=n;return self};GraphRequest.prototype.skipToken=function(token){var self=this;self.urlComponents.oDataQueryParams["$skipToken"]=token;return self};GraphRequest.prototype.count=function(count){var self=this;self.urlComponents.oDataQueryParams["$count"]=count.toString();return self};GraphRequest.prototype.query=function(queryDictionaryOrString){var self=this,otherURLQueryParams=self.urlComponents.otherURLQueryParams;if(typeof queryDictionaryOrString==="string"){var querySplit=queryDictionaryOrString.split("="),queryKey=querySplit[0],queryValue=querySplit[1];otherURLQueryParams[queryKey]=queryValue}else{for(var key in queryDictionaryOrString){otherURLQueryParams[key]=queryDictionaryOrString[key]}}return self};GraphRequest.prototype.buildFullUrl=function(){var self=this;var url=GraphRequestUtil_1.urlJoin([self.urlComponents.host,self.urlComponents.version,self.urlComponents.path])+self.createQueryString();if(self.config.debugLogging){console.log(url)}return url};GraphRequest.prototype.createQueryString=function(){var urlComponents=this.urlComponents,query=[];if(Object.keys(urlComponents.oDataQueryParams).length!==0){for(var property in urlComponents.oDataQueryParams){query.push(property+"="+urlComponents.oDataQueryParams[property])}}if(Object.keys(urlComponents.otherURLQueryParams).length!==0){for(var property in urlComponents.otherURLQueryParams){query.push(property+"="+urlComponents.otherURLQueryParams[property])}}return query.length>0?"?"+query.join("&"):""};GraphRequest.prototype.getRequestOptions=function(){var self=this,defaultHeaders={SdkVersion:"graph-js-"+Constants_1.PACKAGE_VERSION},customizedOptions={headers:{}};if(self.config.middlewareOptions!==undefined){Object.assign(customizedOptions,self.config.middlewareOptions.requestOptions)}Object.assign(customizedOptions,self._options);Object.assign(customizedOptions.headers,defaultHeaders,self._headers);return customizedOptions};GraphRequest.prototype.send=function(request,options){return __awaiter(this,void 0,void 0,function(){var self,requestOptions,middlewareOptions,context_1,error_1;return __generator(this,function(_a){switch(_a.label){case 0:self=this,requestOptions=self.getRequestOptions();if(self.config.middlewareOptions!==undefined){if(self.config.middlewareOptions.requestOptions!==undefined){requestOptions.headers=Object.assign({},self.config.middlewareOptions.requestOptions.headers,requestOptions.headers)}requestOptions=Object.assign({},self.config.middlewareOptions.requestOptions,requestOptions)}middlewareOptions=Object.assign({},self.config.middlewareOptions,{requestOptions:requestOptions});middlewareOptions.responseType=self._responseType;_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.httpClient.sendRequest(request,options,middlewareOptions)];case 2:context_1=_a.sent();self._rawResponse=context_1.rawResponse;return[2,context_1.response];case 3:error_1=_a.sent();throw error_1;case 4:return[2]}})})};GraphRequest.prototype.get=function(){return __awaiter(this,void 0,void 0,function(){var self,url,options,response,error_2;return __generator(this,function(_a){switch(_a.label){case 0:self=this,url=self.buildFullUrl(),options={method:RequestMethod_1.RequestMethod.GET};_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.send(url,options)];case 2:response=_a.sent();return[2,response];case 3:error_2=_a.sent();throw error_2;case 4:return[2]}})})};GraphRequest.prototype.post=function(content){return __awaiter(this,void 0,void 0,function(){var self,url,options,response,error_3;return __generator(this,function(_a){switch(_a.label){case 0:self=this,url=self.buildFullUrl(),options={method:RequestMethod_1.RequestMethod.POST,body:GraphRequestUtil_1.serializeContent(content),headers:content.constructor!==undefined&&content.constructor.name==="FormData"?{}:{"Content-Type":"application/json"}};_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.send(url,options)];case 2:response=_a.sent();return[2,response];case 3:error_3=_a.sent();throw error_3;case 4:return[2]}})})};GraphRequest.prototype.create=function(content){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.post(content)];case 1:return[2,_a.sent()]}})})};GraphRequest.prototype.put=function(content){return __awaiter(this,void 0,void 0,function(){var self,url,options,response;return __generator(this,function(_a){self=this,url=self.buildFullUrl(),options={method:RequestMethod_1.RequestMethod.PUT,body:GraphRequestUtil_1.serializeContent(content),headers:{"Content-Type":"application/octet-stream"}};try{response=self.send(url,options);return[2,response]}catch(error){throw error}return[2]})})};GraphRequest.prototype.patch=function(content){return __awaiter(this,void 0,void 0,function(){var self,url,options,response,error_4;return __generator(this,function(_a){switch(_a.label){case 0:self=this,url=self.buildFullUrl(),options={method:RequestMethod_1.RequestMethod.PATCH,body:GraphRequestUtil_1.serializeContent(content),headers:{"Content-Type":"application/json"}};_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.send(url,options)];case 2:response=_a.sent();return[2,response];case 3:error_4=_a.sent();throw error_4;case 4:return[2]}})})};GraphRequest.prototype.update=function(content){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.patch(content)];case 1:return[2,_a.sent()]}})})};GraphRequest.prototype.delete=function(){return __awaiter(this,void 0,void 0,function(){var self,url,options,response,error_5;return __generator(this,function(_a){switch(_a.label){case 0:self=this,url=self.buildFullUrl(),options={method:RequestMethod_1.RequestMethod.DELETE};_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.send(url,options)];case 2:response=_a.sent();return[2,response];case 3:error_5=_a.sent();throw error_5;case 4:return[2]}})})};GraphRequest.prototype.del=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.delete()];case 1:return[2,_a.sent()]}})})};GraphRequest.prototype.getStream=function(){return __awaiter(this,void 0,void 0,function(){var self,url,options,stream,error_6;return __generator(this,function(_a){switch(_a.label){case 0:self=this,url=self.buildFullUrl(),options={method:RequestMethod_1.RequestMethod.GET};self.responseType(ResponseType_1.ResponseType.STREAM);_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.send(url,options)];case 2:stream=_a.sent();return[2,stream];case 3:error_6=_a.sent();throw error_6;case 4:return[2]}})})};GraphRequest.prototype.putStream=function(stream){return __awaiter(this,void 0,void 0,function(){var self,url,options,response,error_7;return __generator(this,function(_a){switch(_a.label){case 0:self=this,url=self.buildFullUrl(),options={method:RequestMethod_1.RequestMethod.PUT,headers:{"Content-Type":"application/octet-stream"},body:stream};_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.send(url,options)];case 2:response=_a.sent();return[2,response];case 3:error_7=_a.sent();throw error_7;case 4:return[2]}})})};GraphRequest.prototype.getRawResponse=function(){return this._rawResponse};return GraphRequest}();exports.GraphRequest=GraphRequest},{"./Constants":3,"./GraphRequestUtil":5,"./RequestMethod":10,"./ResponseType":11}],5:[function(require,module,exports){(function(Buffer){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.oDataQueryNames=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"];exports.urlJoin=function(urlSegments){var removePostSlash=function(s){return s.replace(/\/+$/,"")},removePreSlash=function(s){return s.replace(/^\/+/,"")},joiner=function(pre,cur){return[removePostSlash(pre),removePreSlash(cur)].join("/")},parts=Array.prototype.slice.call(urlSegments);return parts.reduce(joiner)};exports.serializeContent=function(content){var className=content.constructor.name;if(className==="Buffer"||className==="Blob"||className==="File"||className==="FormData"||typeof content==="string"){return content}if(className==="ArrayBuffer"){content=Buffer.from(content)}else if(className==="Int8Array"||className==="Int16Array"||className==="Int32Array"||className==="Uint8Array"||className==="Uint16Array"||className==="Uint32Array"||className==="Uint8ClampedArray"||className==="Float32Array"||className==="Float64Array"||className==="DataView"){content=Buffer.from(content.buffer)}else{try{content=JSON.stringify(content)}catch(error){throw new Error("Unable to stringify the content")}}return content}}).call(this,require("buffer").Buffer)},{buffer:22}],6:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var HTTPClient=function(){function HTTPClient(middleware){this.middleware=middleware}HTTPClient.prototype.sendRequest=function(request,options,middlewareOptions){return __awaiter(this,void 0,void 0,function(){var context;return __generator(this,function(_a){switch(_a.label){case 0:context={request:request,options:options,middlewareOptions:middlewareOptions};return[4,this.middleware.execute(context)];case 1:_a.sent();return[2,context]}})})};return HTTPClient}();exports.HTTPClient=HTTPClient},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var AuthenticationHandler_1=require("./middleware/AuthenticationHandler");var HTTPMessageHandler_1=require("./middleware/HTTPMessageHandler");var HTTPClient_1=require("./HTTPClient");var HTTPClientFactory=function(){function HTTPClientFactory(){}HTTPClientFactory.createWithAuthenticationProvider=function(authProvider){var authenticationHandler=new AuthenticationHandler_1.AuthenticationHandler(authProvider);var httpMessageHandler=new HTTPMessageHandler_1.HTTPMessageHandler;authenticationHandler.setNext(httpMessageHandler);return HTTPClientFactory.createWithMiddleware(authenticationHandler)};HTTPClientFactory.createWithMiddleware=function(middleware){return new HTTPClient_1.HTTPClient(middleware)};return HTTPClientFactory}();exports.HTTPClientFactory=HTTPClientFactory},{"./HTTPClient":6,"./middleware/AuthenticationHandler":15,"./middleware/HTTPMessageHandler":16}],8:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var msal_1=require("msal");var MSALAuthenticationProvider=function(){function MSALAuthenticationProvider(clientId,scopes,options){var callback=function(errorDesc,token,error,tokenType){};var self=this;self.clientId=clientId;self.scopes=scopes;self.userAgentApplication=new msal_1.UserAgentApplication(self.clientId,undefined,callback,options)}MSALAuthenticationProvider.prototype.getAccessToken=function(){return __awaiter(this,void 0,void 0,function(){var self,error,accessToken,errorMsg_1,idToken,accessToken,error_1,accessToken,errorMsg_2;return __generator(this,function(_a){switch(_a.label){case 0:self=this;if(self.scopes.length===0){error=new Error;error.name="EmptyScopes";error.message="Scopes cannot be empty, Please provide a scope";throw error}_a.label=1;case 1:_a.trys.push([1,3,,13]);return[4,self.userAgentApplication.acquireTokenSilent(self.scopes)];case 2:accessToken=_a.sent();return[2,accessToken];case 3:errorMsg_1=_a.sent();_a.label=4;case 4:_a.trys.push([4,11,,12]);return[4,self.userAgentApplication.loginPopup(self.scopes)];case 5:idToken=_a.sent();_a.label=6;case 6:_a.trys.push([6,8,,10]);return[4,self.userAgentApplication.acquireTokenSilent(self.scopes)];case 7:accessToken=_a.sent();return[2,accessToken];case 8:error_1=_a.sent();return[4,self.userAgentApplication.acquireTokenPopup(self.scopes)];case 9:accessToken=_a.sent();return[2,accessToken];case 10:return[3,12];case 11:errorMsg_2=_a.sent();throw new Error(errorMsg_2);case 12:return[3,13];case 13:return[2]}})})};MSALAuthenticationProvider.prototype.addScopes=function(scopes){if(scopes.length===0){var error=new Error;error.name="EmptyScopes";error.message="Scopes array cannot be empty";throw error}var self=this;self.scopes=Array.from(new Set(self.scopes.concat(scopes)))};MSALAuthenticationProvider.prototype.clearScopes=function(){this.scopes=[]};return MSALAuthenticationProvider}();exports.MSALAuthenticationProvider=MSALAuthenticationProvider},{msal:43}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Range=function(){function Range(minVal,maxVal){if(minVal===void 0){minVal=-1}if(maxVal===void 0){maxVal=-1}var self=this;self.minValue=minVal;self.maxValue=maxVal}return Range}();exports.Range=Range},{}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var RequestMethod;(function(RequestMethod){RequestMethod["GET"]="GET";RequestMethod["PATCH"]="PATCH";RequestMethod["POST"]="POST";RequestMethod["PUT"]="PUT";RequestMethod["DELETE"]="DELETE"})(RequestMethod=exports.RequestMethod||(exports.RequestMethod={}))},{}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ResponseType;(function(ResponseType){ResponseType["ARRAYBUFFER"]="arraybuffer";ResponseType["BLOB"]="blob";ResponseType["DOCUMENT"]="document";ResponseType["JSON"]="json";ResponseType["STREAM"]="stream";ResponseType["TEXT"]="text"})(ResponseType=exports.ResponseType||(exports.ResponseType={}))},{}],12:[function(require,module,exports){(function(Buffer){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var RequestMethod_1=require("../RequestMethod");var BatchRequestContent=function(){function BatchRequestContent(requests){var self=this;self.requests=new Map;if(typeof requests!=="undefined"){var limit=BatchRequestContent.requestLimit;if(requests.length>limit){var error=new Error("Maximum requests limit exceeded, Max allowed number of requests are "+limit);error.name="Limit Exceeded Error";throw error}for(var _i=0,requests_1=requests;_i<requests_1.length;_i++){var req=requests_1[_i];self.addRequest(req)}}}BatchRequestContent.prototype.addRequest=function(request){var self=this,limit=BatchRequestContent.requestLimit;if(request.id===""){var error=new Error("Id for a request is empty, Please provide an unique id");error.name="Empty Id For Request";throw error}if(self.requests.size===limit){var error=new Error("Maximum requests limit exceeded, Max allowed number of requests are "+limit);error.name="Limit Exceeded Error";throw error}if(self.requests.has(request.id)){var error=new Error("Adding request with duplicate id "+request.id+", Make the id of the requests unique");error.name="Duplicate RequestId Error";throw error}self.requests.set(request.id,request);return request.id};BatchRequestContent.prototype.removeRequest=function(requestId){var self=this,deleteStatus=self.requests.delete(requestId),iterator=self.requests.entries(),cur=iterator.next();while(!cur.done){var dependencies=cur.value[1].dependsOn;if(typeof dependencies!=="undefined"){var index=dependencies.indexOf(requestId);if(index!==-1){dependencies.splice(index,1)}if(dependencies.length===0){delete cur.value[1].dependsOn}}cur=iterator.next()}return deleteStatus};BatchRequestContent.prototype.getContent=function(){return __awaiter(this,void 0,void 0,function(){var self,requestBody,requests,iterator,cur,error,error,requestStep,batchRequestData,error;return __generator(this,function(_a){switch(_a.label){case 0:self=this,requestBody={},requests=[],iterator=self.requests.entries(),cur=iterator.next();if(cur.done){error=new Error("No requests added yet, Please add at least one request.");error.name="Empty Payload";throw error}if(!BatchRequestContent.validateDependencies(self.requests)){error=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");error.name="Invalid Dependency";throw error}_a.label=1;case 1:if(!!cur.done)return[3,3];requestStep=cur.value[1];return[4,BatchRequestContent.getRequestData(requestStep.request)];case 2:batchRequestData=_a.sent();if(batchRequestData.body!==undefined&&(batchRequestData.headers===undefined||batchRequestData.headers["content-type"]===undefined)){error=new Error("Content-type header is not mentioned for request #"+requestStep.id+", For request having body, Content-type header should be mentioned");error.name="Invalid Content-type header";throw error}batchRequestData.id=requestStep.id;if(requestStep.dependsOn!==undefined&&requestStep.dependsOn.length>0){batchRequestData.dependsOn=requestStep.dependsOn}requests.push(batchRequestData);cur=iterator.next();return[3,1];case 3:requestBody.requests=requests;return[2,requestBody]}})})};BatchRequestContent.validateDependencies=function(requests){var isParallel=function(requests){var iterator=requests.entries(),cur=iterator.next();while(!cur.done){var curReq=cur.value[1];if(curReq.dependsOn!==undefined&&curReq.dependsOn.length>0){return false}cur=iterator.next()}return true};var isSerial=function(requests){var iterator=requests.entries(),cur=iterator.next();var firstRequest=cur.value[1];if(firstRequest.dependsOn!==undefined&&firstRequest.dependsOn.length>0){return false}var prev=cur;cur=iterator.next();while(!cur.done){var curReq=cur.value[1];if(curReq.dependsOn===undefined||curReq.dependsOn.length!==1||curReq.dependsOn[0]!==prev.value[1].id){return false}prev=cur;cur=iterator.next()}return true};var isSame=function(requests){var iterator=requests.entries(),cur=iterator.next();var firstRequest=cur.value[1],dependencyId;if(firstRequest.dependsOn===undefined||firstRequest.dependsOn.length===0){dependencyId=firstRequest.id}else{if(firstRequest.dependsOn.length===1){var fDependencyId=firstRequest.dependsOn[0];if(fDependencyId!==firstRequest.id&&requests.has(fDependencyId)){dependencyId=fDependencyId}else{return false}}else{return false}}cur=iterator.next();while(!cur.done){var curReq=cur.value[1];if((curReq.dependsOn===undefined||curReq.dependsOn.length===0)&&dependencyId!==curReq.id){return false}if(curReq.dependsOn!==undefined&&curReq.dependsOn.length!==0){if(curReq.dependsOn.length===1&&(curReq.id===dependencyId||curReq.dependsOn[0]!==dependencyId)){return false}if(curReq.dependsOn.length>1){return false}}cur=iterator.next()}return true};if(requests.size===0){var error=new Error("Empty requests map, Please provide at least one request.");error.name="Empty Requests Error";throw error}return isParallel(requests)||isSerial(requests)||isSame(requests)};BatchRequestContent.getRequestData=function(request){return __awaiter(this,void 0,void 0,function(){var requestData,hasHttpRegex,headers,_a;return __generator(this,function(_b){switch(_b.label){case 0:requestData={};hasHttpRegex=new RegExp("^https?://");if(hasHttpRegex.test(request.url)){requestData.url="/"+request.url.split(/.*?\/\/.*?\//)[1]}else{requestData.url=request.url}requestData.method=request.method;headers={};request.headers.forEach(function(value,key){headers[key]=value});if(Object.keys(headers).length){requestData.headers=headers}if(!(request.method===RequestMethod_1.RequestMethod.PATCH||request.method===RequestMethod_1.RequestMethod.POST||request.method===RequestMethod_1.RequestMethod.PUT))return[3,2];_a=requestData;return[4,BatchRequestContent.getRequestBody(request)];case 1:_a.body=_b.sent();_b.label=2;case 2:return[2,requestData]}})})};BatchRequestContent.getRequestBody=function(request){return __awaiter(this,void 0,void 0,function(){var bodyParsed,body,cloneReq,e_1,blob_1,reader_1,buffer,e_2;return __generator(this,function(_a){switch(_a.label){case 0:bodyParsed=false;_a.label=1;case 1:_a.trys.push([1,3,,4]);cloneReq=request.clone();return[4,cloneReq.json()];case 2:body=_a.sent();bodyParsed=true;return[3,4];case 3:e_1=_a.sent();return[3,4];case 4:if(!!bodyParsed)return[3,12];_a.label=5;case 5:_a.trys.push([5,11,,12]);if(!(typeof Blob!=="undefined"))return[3,8];return[4,request.blob()];case 6:blob_1=_a.sent();reader_1=new FileReader;return[4,new Promise(function(resolve){reader_1.addEventListener("load",function(){var dataURL=reader_1.result,regex=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$"),segments=regex.exec(dataURL);resolve(segments[4])},false);reader_1.readAsDataURL(blob_1)})];case 7:body=_a.sent();return[3,10];case 8:if(!(typeof Buffer!=="undefined"))return[3,10];return[4,request.buffer()];case 9:buffer=_a.sent();body=buffer.toString("base64");_a.label=10;case 10:bodyParsed=true;return[3,12];case 11:e_2=_a.sent();return[3,12];case 12:return[2,body]}})})};BatchRequestContent.prototype.addDependency=function(dependentId,dependencyId){var self=this;if(!self.requests.has(dependentId)){var error=new Error("Dependent "+dependentId+" does not exists, Please check the id");error.name="Invalid Dependent";throw error}if(typeof dependencyId!=="undefined"&&!self.requests.has(dependencyId)){var error=new Error("Dependency "+dependencyId+" does not exists, Please check the id");error.name="Invalid Dependency";throw error}if(typeof dependencyId!=="undefined"){var dependent=self.requests.get(dependentId);if(dependent.dependsOn===undefined){dependent.dependsOn=[]}if(dependent.dependsOn.includes(dependencyId)){var error=new Error("Dependency "+dependencyId+" is already added for the request "+dependentId);error.name="Duplicate Dependency";throw error}dependent.dependsOn.push(dependencyId)}else{var prev=void 0,iterator=self.requests.entries(),cur=iterator.next();while(!cur.done&&cur.value[1].id!==dependentId){prev=cur;cur=iterator.next()}if(typeof prev!=="undefined"){var dependencyId_1=prev.value[0];if(cur.value[1].dependsOn===undefined){cur.value[1].dependsOn=[]}if(cur.value[1].dependsOn.includes(dependencyId_1)){var error=new Error("Dependency "+dependencyId_1+" is already added for the request "+dependentId);error.name="Duplicate Dependency";throw error}cur.value[1].dependsOn.push(dependencyId_1)}else{var error=new Error("Can't add dependency "+dependencyId+", There is only a dependent request in the batch");error.name="Invalid Dependency Addition";throw error}}};BatchRequestContent.prototype.removeDependency=function(dependentId,dependencyId){var request=this.requests.get(dependentId);if(typeof request==="undefined"||request.dependsOn===undefined||request.dependsOn.length===0){return false}if(typeof dependencyId!=="undefined"){var index=request.dependsOn.indexOf(dependencyId);if(index===-1){return false}request.dependsOn.splice(index,1);return true}else{delete request.dependsOn;return true}};BatchRequestContent.requestLimit=20;return BatchRequestContent}();exports.BatchRequestContent=BatchRequestContent}).call(this,require("buffer").Buffer)},{"../RequestMethod":10,buffer:22}],13:[function(require,module,exports){"use strict";var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var BatchResponseContent=function(){function BatchResponseContent(response){var self=this;self.responses=new Map;self.update(response)}BatchResponseContent.prototype.update=function(response){var self=this;self.nextLink=response["@nextLink"];var responses=response.responses;for(var i=0,l=responses.length;i<l;i++){self.responses.set(responses[i].id,self.createResponseObject(responses[i]))}};BatchResponseContent.prototype.createResponseObject=function(responseJSON){var body=responseJSON.body,options={};options.status=responseJSON.status;if(responseJSON.statusText!==undefined){options.statusText=responseJSON.statusText}options.headers=responseJSON.headers;return new Response(body,options)};BatchResponseContent.prototype.getResponseById=function(requestId){return this.responses.get(requestId)};BatchResponseContent.prototype.getResponses=function(){return this.responses};BatchResponseContent.prototype.getResponsesIterator=function(){var self,iterator,cur;return __generator(this,function(_a){switch(_a.label){case 0:self=this,iterator=self.responses.entries(),cur=iterator.next();_a.label=1;case 1:if(!!cur.done)return[3,3];return[4,cur.value];case 2:_a.sent();cur=iterator.next();return[3,1];case 3:return[2]}})};return BatchResponseContent}();exports.BatchResponseContent=BatchResponseContent},{}],14:[function(require,module,exports){"use strict";function __export(m){for(var p in m)if(!exports.hasOwnProperty(p))exports[p]=m[p]}Object.defineProperty(exports,"__esModule",{value:true});__export(require("./Client"));__export(require("./GraphRequest"));__export(require("./ResponseType"));__export(require("./MSALAuthenticationProvider"));__export(require("./tasks/OneDriveLargeFileUploadTask"));__export(require("./tasks/PageIterator"));__export(require("./content/BatchRequestContent"));__export(require("./content/BatchResponseContent"))},{"./Client":2,"./GraphRequest":4,"./MSALAuthenticationProvider":8,"./ResponseType":11,"./content/BatchRequestContent":12,"./content/BatchResponseContent":13,"./tasks/OneDriveLargeFileUploadTask":18,"./tasks/PageIterator":20}],15:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var AuthenticationHandler=function(){function AuthenticationHandler(authProvider){this.authProvider=authProvider}AuthenticationHandler.prototype.execute=function(context){return __awaiter(this,void 0,void 0,function(){var token,bearerKey,options,headerType,error_1;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,3,,4]);return[4,this.authProvider.getAccessToken()];case 1:token=_a.sent();bearerKey="Bearer "+token;if(context.request.constructor.name==="Request"){context.request.headers.set("Authorization",bearerKey)}else{options=context.options;if(options.headers===undefined){options.headers={Authorization:bearerKey}}else{headerType=options.headers.constructor.name;if(headerType==="Headers"){options.headers.set("Authorization",bearerKey)}else if(headerType==="Array"){options.headers.push(["Authorization",bearerKey])}else{Object.assign(options.headers,{Authorization:bearerKey})}}}return[4,this.nextMiddleware.execute(context)];case 2:_a.sent();return[3,4];case 3:error_1=_a.sent();throw error_1;case 4:return[2]}})})};AuthenticationHandler.prototype.setNext=function(next){this.nextMiddleware=next};return AuthenticationHandler}();exports.AuthenticationHandler=AuthenticationHandler},{}],16:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var ResponseType_1=require("../ResponseType");var DocumentType;(function(DocumentType){DocumentType["TEXT_HTML"]="text/html";DocumentType["TEXT_XML"]="text/xml";DocumentType["APPLICATION_XML"]="application/xml";DocumentType["APPLICATION_XHTML"]="application/xhtml+xml"})(DocumentType||(DocumentType={}));var HTTPMessageHandler=function(){function HTTPMessageHandler(){if(HTTPMessageHandler.DocumentTypes===undefined){HTTPMessageHandler.DocumentTypes=Object.keys(DocumentType).map(function(k){return DocumentType[k]})}}HTTPMessageHandler.prototype.parseDocumentResponse=function(response,type){if(typeof DOMParser!=="undefined"){return new Promise(function(resolve,reject){response.text().then(function(xmlString){try{var parser=new DOMParser,xmlDoc=parser.parseFromString(xmlString,type);resolve(xmlDoc)}catch(error){reject(error)}})})}else{return Promise.resolve(response.body)}};HTTPMessageHandler.prototype.convertResponse=function(response,type){return __awaiter(this,void 0,void 0,function(){var self,responseValue,contentType,mimeType;return __generator(this,function(_a){if(response.status===204){return[2,Promise.resolve()]}self=this;switch(type){case ResponseType_1.ResponseType.ARRAYBUFFER:responseValue=response.arrayBuffer();break;case ResponseType_1.ResponseType.BLOB:responseValue=response.blob();break;case ResponseType_1.ResponseType.DOCUMENT:responseValue=self.parseDocumentResponse(response,DocumentType.TEXT_XML);break;case ResponseType_1.ResponseType.JSON:responseValue=response.json();break;case ResponseType_1.ResponseType.STREAM:responseValue=Promise.resolve(response.body);break;case ResponseType_1.ResponseType.TEXT:responseValue=response.text();break;default:contentType=response.headers.get("Content-type");if(contentType!==null){mimeType=contentType.split(";")[0];if(HTTPMessageHandler.DocumentTypes.includes(mimeType)){responseValue=self.parseDocumentResponse(response,mimeType)}else{responseValue=response.json()}}else{responseValue=Promise.resolve(response.body)}break}return[2,responseValue]})})};HTTPMessageHandler.prototype.defaultError=function(statusCode){if(statusCode===void 0){statusCode=-1}return{statusCode:statusCode,code:null,message:null,requestId:null,date:new Date,body:null}};HTTPMessageHandler.prototype.buildError=function(error){var gError=this.defaultError();if(error.name!==undefined){gError.code=error.name}gError.body=error.toString();gError.message=error.message;gError.date=new Date;return gError};HTTPMessageHandler.prototype.buildErrorFromResponse=function(error,statusCode){return{statusCode:statusCode,code:error.code,message:error.message,requestId:error.innerError!==undefined?error.innerError["request-id"]:"",date:error.innerError!==undefined?new Date(error.innerError.date):new Date,body:error}};HTTPMessageHandler.prototype.execute=function(context){return __awaiter(this,void 0,void 0,function(){var self_1,optionsHeaders,options,middlewareOptionsHeaders,rawResponse,responseType,response,error_1,self_2;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,3,,4]);self_1=this,optionsHeaders=Object.assign({},context.options.headers),options=Object.assign({},context.options);if(context.middlewareOptions!==undefined&&context.middlewareOptions.requestOptions!==undefined){middlewareOptionsHeaders=Object.assign({},context.middlewareOptions.requestOptions.headers);Object.assign(options,context.middlewareOptions.requestOptions);Object.assign(options.headers,optionsHeaders,middlewareOptionsHeaders)}return[4,fetch(context.request,options)];case 1:rawResponse=_a.sent();context.rawResponse=rawResponse;responseType=void 0;if(context.middlewareOptions!==undefined){responseType=context.middlewareOptions.responseType}return[4,this.convertResponse(rawResponse,responseType)];case 2:response=_a.sent();if(rawResponse.ok){context.response=response}else{if(response&&response.error){throw self_1.buildErrorFromResponse(response.error,rawResponse.status)}else{throw self_1.defaultError(rawResponse.status)}}return[3,4];case 3:error_1=_a.sent();self_2=this;if(error_1.requestId!==undefined){throw error_1}else if(error_1 instanceof Error){throw self_2.buildError(error_1)}else{throw self_2.defaultError()}return[3,4];case 4:return[2]}})})};return HTTPMessageHandler}();exports.HTTPMessageHandler=HTTPMessageHandler},{"../ResponseType":11}],17:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var Range_1=require("../Range");var LargeFileUploadTask=function(){function LargeFileUploadTask(client,file,uploadSession,options){this.DEFAULT_FILE_SIZE=5*1024*1024;var self=this;self.client=client;self.file=file;if(options.rangeSize===undefined){options.rangeSize=self.DEFAULT_FILE_SIZE}self.options=options;self.uploadSession=uploadSession;self.nextRange=new Range_1.Range(0,self.options.rangeSize-1)}LargeFileUploadTask.prototype.parseRange=function(ranges){var rangeStr=ranges[0];if(typeof rangeStr==="undefined"||rangeStr===""){return new Range_1.Range}var firstRange=rangeStr.split("-"),minVal=parseInt(firstRange[0]),maxVal=parseInt(firstRange[1]);if(Number.isNaN(maxVal)){maxVal=this.file.size-1}return new Range_1.Range(minVal,maxVal)};LargeFileUploadTask.prototype.updateTaskStatus=function(response){var self=this;self.uploadSession.expiry=new Date(response.expirationDateTime);self.nextRange=self.parseRange(response.nextExpectedRanges)};LargeFileUploadTask.prototype.getNextRange=function(){var self=this;if(self.nextRange.minValue===-1){return self.nextRange}var minVal=self.nextRange.minValue,maxValue=minVal+self.options.rangeSize-1;if(maxValue>=self.file.size){maxValue=self.file.size-1}return new Range_1.Range(minVal,maxValue)};LargeFileUploadTask.prototype.sliceFile=function(range){var blob=this.file.content.slice(range.minValue,range.maxValue+1);return blob};LargeFileUploadTask.prototype.upload=function(){return __awaiter(this,void 0,void 0,function(){var self,nextRange,err,fileSlice,response,err_1;return __generator(this,function(_a){switch(_a.label){case 0:self=this;_a.label=1;case 1:_a.trys.push([1,5,,6]);_a.label=2;case 2:if(!true)return[3,4];nextRange=self.getNextRange();if(nextRange.maxValue===-1){err=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");err.name="Invalid Session";throw err}fileSlice=self.sliceFile(nextRange);return[4,self.uploadSlice(fileSlice,nextRange,self.file.size)];case 3:response=_a.sent();if(response.id!==undefined){return[2,response]}else{self.updateTaskStatus(response)}return[3,2];case 4:return[3,6];case 5:err_1=_a.sent();throw err_1;case 6:return[2]}})})};LargeFileUploadTask.prototype.uploadSlice=function(fileSlice,range,totalSize){return __awaiter(this,void 0,void 0,function(){var self,err_2;return __generator(this,function(_a){switch(_a.label){case 0:self=this;_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.client.api(self.uploadSession.url).headers({"Content-Length":""+(range.maxValue-range.minValue+1),"Content-Range":"bytes "+range.minValue+"-"+range.maxValue+"/"+totalSize}).put(fileSlice)];case 2:return[2,_a.sent()];case 3:err_2=_a.sent();throw err_2;case 4:return[2]}})})};LargeFileUploadTask.prototype.cancel=function(){return __awaiter(this,void 0,void 0,function(){var self,err_3;return __generator(this,function(_a){switch(_a.label){case 0:self=this;_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.client.api(self.uploadSession.url).delete()];case 2:return[2,_a.sent()];case 3:err_3=_a.sent();throw err_3;case 4:return[2]}})})};LargeFileUploadTask.prototype.getStatus=function(){return __awaiter(this,void 0,void 0,function(){var self,response,err_4;return __generator(this,function(_a){switch(_a.label){case 0:self=this;_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,self.client.api(self.uploadSession.url).get()];case 2:response=_a.sent();self.updateTaskStatus(response);return[2,response];case 3:err_4=_a.sent();throw err_4;case 4:return[2]}})})};LargeFileUploadTask.prototype.resume=function(){return __awaiter(this,void 0,void 0,function(){var self,err_5;return __generator(this,function(_a){switch(_a.label){case 0:self=this;_a.label=1;case 1:_a.trys.push([1,4,,5]);return[4,self.getStatus()];case 2:_a.sent();return[4,self.upload()];case 3:return[2,_a.sent()];case 4:err_5=_a.sent();throw err_5;case 5:return[2]}})})};return LargeFileUploadTask}();exports.LargeFileUploadTask=LargeFileUploadTask},{"../Range":9}],18:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var LargeFileUploadTask_1=require("./LargeFileUploadTask");var OneDriveLargeFileUploadTaskUtil_1=require("./OneDriveLargeFileUploadTaskUtil");var OneDriveLargeFileUploadTask=function(_super){__extends(OneDriveLargeFileUploadTask,_super);function OneDriveLargeFileUploadTask(client,file,uploadSession,options){return _super.call(this,client,file,uploadSession,options)||this}OneDriveLargeFileUploadTask.create=function(client,file,options){return __awaiter(this,void 0,void 0,function(){var fileObj,_file,b,requestUrl,session,rangeSize,err_1;return __generator(this,function(_a){switch(_a.label){case 0:fileObj={};fileObj.name=options.fileName;switch(file.constructor.name){case"Blob":fileObj.content=new File([file],fileObj.name);fileObj.size=fileObj.content.size;break;case"File":_file=file;fileObj.content=_file;fileObj.size=_file.size;break;case"Buffer":b=file;fileObj.size=b.byteLength-b.byteOffset;fileObj.content=b.buffer.slice(b.byteOffset,b.byteOffset+b.byteLength);break}_a.label=1;case 1:_a.trys.push([1,3,,4]);requestUrl=OneDriveLargeFileUploadTask.constructCreateSessionUrl(options.fileName,options.path);return[4,OneDriveLargeFileUploadTask.createUploadSession(client,requestUrl,options.fileName)];case 2:session=_a.sent();rangeSize=OneDriveLargeFileUploadTaskUtil_1.getValidRangeSize(options.rangeSize);return[2,new OneDriveLargeFileUploadTask(client,fileObj,session,{rangeSize:rangeSize})];case 3:err_1=_a.sent();throw err_1;case 4:return[2]}})})};OneDriveLargeFileUploadTask.constructCreateSessionUrl=function(fileName,path){if(path===void 0){path=OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH}fileName=fileName.trim();path=path.trim();if(path===""){path="/"}if(path[0]!=="/"){path="/"+path}if(path[path.length-1]!=="/"){path=path+"/"}return encodeURI("/me/drive/root:"+path+fileName+":/createUploadSession")};OneDriveLargeFileUploadTask.createUploadSession=function(client,requestUrl,fileName){return __awaiter(this,void 0,void 0,function(){var payload,session,largeFileUploadSession,err_2;return __generator(this,function(_a){switch(_a.label){case 0:payload={item:{"@microsoft.graph.conflictBehavior":"rename",name:fileName}};_a.label=1;case 1:_a.trys.push([1,3,,4]);return[4,client.api(requestUrl).post(payload)];case 2:session=_a.sent(),largeFileUploadSession={url:session.uploadUrl,expiry:new Date(session.expirationDateTime)};return[2,largeFileUploadSession];case 3:err_2=_a.sent();throw err_2;case 4:return[2]}})})};OneDriveLargeFileUploadTask.prototype.commit=function(requestUrl){return __awaiter(this,void 0,void 0,function(){var self,payload,err_3;return __generator(this,function(_a){switch(_a.label){case 0:self=this;_a.label=1;case 1:_a.trys.push([1,3,,4]);payload={name:self.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":self.uploadSession.url};return[4,self.client.api(requestUrl).put(payload)];case 2:return[2,_a.sent()];case 3:err_3=_a.sent();throw err_3;case 4:return[2]}})})};OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH="/";return OneDriveLargeFileUploadTask}(LargeFileUploadTask_1.LargeFileUploadTask);exports.OneDriveLargeFileUploadTask=OneDriveLargeFileUploadTask},{"./LargeFileUploadTask":17,"./OneDriveLargeFileUploadTaskUtil":19}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DEFAULT_FILE_SIZE=5*1024*1024;var roundTo320KB=function(value){if(value>320*1024){value=Math.floor(value/(320*1024))*320*1024}return value};exports.getValidRangeSize=function(rangeSize){if(rangeSize===void 0){rangeSize=DEFAULT_FILE_SIZE}var sixtyMB=60*1024*1024;if(rangeSize>sixtyMB){rangeSize=sixtyMB}return roundTo320KB(rangeSize)}},{}],20:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var PageIterator=function(){function PageIterator(client,pageCollection,callback){var self=this;self.client=client;self.collection=pageCollection.value;self.nextLink=pageCollection["@odata.nextLink"];self.deltaLink=pageCollection["@odata.deltaLink"];self.callback=callback}PageIterator.prototype.iterationHelper=function(){var self=this;if(self.collection===undefined||self.collection.length===0){return false}var advance=true;while(advance&&self.collection.length!==0){var item=self.collection.shift();advance=self.callback(item)}return advance};PageIterator.prototype.fetchAndUpdateNextPageData=function(){return __awaiter(this,void 0,void 0,function(){var self_1,response,error_1;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,2,,3]);self_1=this;return[4,self_1.client.api(self_1.nextLink).get()];case 1:response=_a.sent();self_1.collection=response.value;self_1.nextLink=response["@odata.nextLink"];self_1.deltaLink=response["@odata.deltaLink"];return[3,3];case 2:error_1=_a.sent();throw error_1;case 3:return[2]}})})};PageIterator.prototype.getDeltaLink=function(){return this.deltaLink};PageIterator.prototype.iterate=function(){return __awaiter(this,void 0,void 0,function(){var self_2,advance,error_2;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,6,,7]);self_2=this,advance=self_2.iterationHelper();_a.label=1;case 1:if(!advance)return[3,5];if(!(self_2.nextLink!==undefined))return[3,3];return[4,self_2.fetchAndUpdateNextPageData()];case 2:_a.sent();advance=self_2.iterationHelper();return[3,4];case 3:advance=false;_a.label=4;case 4:return[3,1];case 5:return[3,7];case 6:error_2=_a.sent();throw error_2;case 7:return[2]}})})};PageIterator.prototype.resume=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){try{return[2,this.iterate()]}catch(error){throw error}return[2]})})};return PageIterator}();exports.PageIterator=PageIterator},{}],21:[function(require,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var validLen=b64.indexOf("=");if(validLen===-1)validLen=len;var placeHoldersLen=validLen===len?0:4-validLen%4;return[validLen,placeHoldersLen]}function byteLength(b64){var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function _byteLength(b64,validLen,placeHoldersLen){return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function toByteArray(b64){var tmp;var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen));var curByte=0;var len=placeHoldersLen>0?validLen-4:validLen;for(var i=0;i<len;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[curByte++]=tmp>>16&255;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}if(placeHoldersLen===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[curByte++]=tmp&255}if(placeHoldersLen===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255);output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"=")}return parts.join("")}},{}],22:[function(require,module,exports){"use strict";var base64=require("base64-js");var ieee754=require("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}var buf=new Uint8Array(length);buf.__proto__=Buffer.prototype;return buf}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="string"){return fromString(value,encodingOrOffset)}if(ArrayBuffer.isView(value)){return fromArrayLike(value)}if(value==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var valueOf=value.valueOf&&value.valueOf();if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}var b=fromObject(value);if(b)return b;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==="function"){return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer.allocUnsafe=function(size){return allocUnsafe(size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer.prototype;return buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj.length!==undefined){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true&&b!==Buffer.prototype};Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength);if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength);if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof string)}var len=string.length;var mustMatch=arguments.length>2&&arguments[2]===true;if(!mustMatch&&len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4)}return this};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();if(this.length>max)str+=" ... ";return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof target)}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break}}if(found)return i}}return-1}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(this===target&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}if(val.length===1){var code=val.charCodeAt(0);if(encoding==="utf8"&&code<128||encoding==="latin1"){val=code}}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding);var len=bytes.length;if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.split("=")[0];str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isInstance(obj,type){return obj instanceof type||obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!==obj}},{"base64-js":21,ieee754:23}],23:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var Authority_1=require("./Authority");var XHRClient_1=require("./XHRClient");var AadAuthority=function(_super){tslib_1.__extends(AadAuthority,_super);function AadAuthority(authority,validateAuthority){return _super.call(this,authority,validateAuthority)||this}Object.defineProperty(AadAuthority.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return AadAuthority.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:true,configurable:true});Object.defineProperty(AadAuthority.prototype,"AuthorityType",{get:function(){return Authority_1.AuthorityType.Aad},enumerable:true,configurable:true});AadAuthority.prototype.GetOpenIdConfigurationEndpointAsync=function(){var _this=this;var resultPromise=new Promise(function(resolve,reject){return resolve(_this.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled){return resultPromise}var host=this.CanonicalAuthorityUrlComponents.HostNameAndPort;if(this.IsInTrustedHostList(host)){return resultPromise}var client=new XHRClient_1.XhrClient;return client.sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",true).then(function(response){return response.tenant_discovery_endpoint})};AadAuthority.prototype.IsInTrustedHostList=function(host){return AadAuthority.TrustedHostList[host.toLowerCase()]};AadAuthority.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance";AadAuthority.TrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"};return AadAuthority}(Authority_1.Authority);exports.AadAuthority=AadAuthority},{"./Authority":29,"./XHRClient":42,tslib:44}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var AccessTokenCacheItem=function(){function AccessTokenCacheItem(key,value){this.key=key;this.value=value}return AccessTokenCacheItem}();exports.AccessTokenCacheItem=AccessTokenCacheItem},{}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var AccessTokenKey=function(){function AccessTokenKey(authority,clientId,scopes,uid,utid){this.authority=authority;this.clientId=clientId;this.scopes=scopes;this.userIdentifier=Utils_1.Utils.base64EncodeStringUrlSafe(uid)+"."+Utils_1.Utils.base64EncodeStringUrlSafe(utid)}return AccessTokenKey}();exports.AccessTokenKey=AccessTokenKey},{"./Utils":41}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var AccessTokenValue=function(){function AccessTokenValue(accessToken,idToken,expiresIn,clientInfo){this.accessToken=accessToken;this.idToken=idToken;this.expiresIn=expiresIn;this.clientInfo=clientInfo}return AccessTokenValue}();exports.AccessTokenValue=AccessTokenValue},{}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var AuthenticationRequestParameters=function(){function AuthenticationRequestParameters(authority,clientId,scope,responseType,redirectUri,state){this.authorityInstance=authority;this.clientId=clientId;this.scopes=scope;this.responseType=responseType;this.redirectUri=redirectUri;this.correlationId=Utils_1.Utils.createNewGuid();this.state=state&&!Utils_1.Utils.isEmpty(state)?Utils_1.Utils.createNewGuid()+"|"+state:Utils_1.Utils.createNewGuid();this.nonce=Utils_1.Utils.createNewGuid();this.xClientSku="MSAL.JS";this.xClientVer=Utils_1.Utils.getLibraryVersion()}Object.defineProperty(AuthenticationRequestParameters.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},enumerable:true,configurable:true});AuthenticationRequestParameters.prototype.createNavigateUrl=function(scopes){var str=this.createNavigationUrlString(scopes);var authEndpoint=this.authorityInstance.AuthorizationEndpoint;if(authEndpoint.indexOf("?")<0){authEndpoint+="?"}else{authEndpoint+="&"}var requestUrl=""+authEndpoint+str.join("&");return requestUrl};AuthenticationRequestParameters.prototype.createNavigationUrlString=function(scopes){if(!scopes){scopes=[this.clientId]}if(scopes.indexOf(this.clientId)===-1){scopes.push(this.clientId)}var str=[];str.push("response_type="+this.responseType);this.translateclientIdUsedInScope(scopes);str.push("scope="+encodeURIComponent(this.parseScope(scopes)));str.push("client_id="+encodeURIComponent(this.clientId));str.push("redirect_uri="+encodeURIComponent(this.redirectUri));str.push("state="+encodeURIComponent(this.state));str.push("nonce="+encodeURIComponent(this.nonce));str.push("client_info=1");str.push("x-client-SKU="+this.xClientSku);str.push("x-client-Ver="+this.xClientVer);if(this.extraQueryParameters){str.push(this.extraQueryParameters)}str.push("client-request-id="+encodeURIComponent(this.correlationId));return str};AuthenticationRequestParameters.prototype.translateclientIdUsedInScope=function(scopes){var clientIdIndex=scopes.indexOf(this.clientId);if(clientIdIndex>=0){scopes.splice(clientIdIndex,1);if(scopes.indexOf("openid")===-1){scopes.push("openid")}if(scopes.indexOf("profile")===-1){scopes.push("profile")}}};AuthenticationRequestParameters.prototype.parseScope=function(scopes){var scopeList="";if(scopes){for(var i=0;i<scopes.length;++i){scopeList+=i!==scopes.length-1?scopes[i]+" ":scopes[i]}}return scopeList};return AuthenticationRequestParameters}();exports.AuthenticationRequestParameters=AuthenticationRequestParameters},{"./Utils":41}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var ErrorMessage_1=require("./ErrorMessage");var XHRClient_1=require("./XHRClient");var AuthorityType;(function(AuthorityType){AuthorityType[AuthorityType["Aad"]=0]="Aad";AuthorityType[AuthorityType["Adfs"]=1]="Adfs";AuthorityType[AuthorityType["B2C"]=2]="B2C"})(AuthorityType=exports.AuthorityType||(exports.AuthorityType={}));var Authority=function(){function Authority(authority,validateAuthority){this.IsValidationEnabled=validateAuthority;this.CanonicalAuthority=authority;this.validateAsUri()}Object.defineProperty(Authority.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:true,configurable:true});Object.defineProperty(Authority.prototype,"AuthorizationEndpoint",{get:function(){this.validateResolved();return this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:true,configurable:true});Object.defineProperty(Authority.prototype,"EndSessionEndpoint",{get:function(){this.validateResolved();return this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:true,configurable:true});Object.defineProperty(Authority.prototype,"SelfSignedJwtAudience",{get:function(){this.validateResolved();return this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:true,configurable:true});Authority.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse){throw"Please call ResolveEndpointsAsync first"}};Object.defineProperty(Authority.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(url){this.canonicalAuthority=Utils_1.Utils.CanonicalizeUri(url);this.canonicalAuthorityUrlComponents=null},enumerable:true,configurable:true});Object.defineProperty(Authority.prototype,"CanonicalAuthorityUrlComponents",{get:function(){if(!this.canonicalAuthorityUrlComponents){this.canonicalAuthorityUrlComponents=Utils_1.Utils.GetUrlComponents(this.CanonicalAuthority)}return this.canonicalAuthorityUrlComponents},enumerable:true,configurable:true});Object.defineProperty(Authority.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:true,configurable:true});Authority.prototype.validateAsUri=function(){var components;try{components=this.CanonicalAuthorityUrlComponents}catch(e){throw ErrorMessage_1.ErrorMessage.invalidAuthorityType}if(!components.Protocol||components.Protocol.toLowerCase()!=="https:"){throw ErrorMessage_1.ErrorMessage.authorityUriInsecure}if(!components.PathSegments||components.PathSegments.length<1){throw ErrorMessage_1.ErrorMessage.authorityUriInvalidPath}};Authority.prototype.DiscoverEndpoints=function(openIdConfigurationEndpoint){var client=new XHRClient_1.XhrClient;return client.sendRequestAsync(openIdConfigurationEndpoint,"GET",true).then(function(response){return{AuthorizationEndpoint:response.authorization_endpoint,EndSessionEndpoint:response.end_session_endpoint,Issuer:response.issuer}})};Authority.prototype.ResolveEndpointsAsync=function(){var _this=this;var openIdConfigurationEndpoint="";return this.GetOpenIdConfigurationEndpointAsync().then(function(openIdConfigurationEndpointResponse){openIdConfigurationEndpoint=openIdConfigurationEndpointResponse;return _this.DiscoverEndpoints(openIdConfigurationEndpoint)}).then(function(tenantDiscoveryResponse){_this.tenantDiscoveryResponse=tenantDiscoveryResponse;return _this})};return Authority}();exports.Authority=Authority},{"./ErrorMessage":34,"./Utils":41,"./XHRClient":42}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var AadAuthority_1=require("./AadAuthority");var B2cAuthority_1=require("./B2cAuthority");var Authority_1=require("./Authority");var ErrorMessage_1=require("./ErrorMessage");var AuthorityFactory=function(){function AuthorityFactory(){}AuthorityFactory.DetectAuthorityFromUrl=function(authorityUrl){authorityUrl=Utils_1.Utils.CanonicalizeUri(authorityUrl);var components=Utils_1.Utils.GetUrlComponents(authorityUrl);var pathSegments=components.PathSegments;switch(pathSegments[0]){case"tfp":return Authority_1.AuthorityType.B2C;case"adfs":return Authority_1.AuthorityType.Adfs;default:return Authority_1.AuthorityType.Aad}};AuthorityFactory.CreateInstance=function(authorityUrl,validateAuthority){var type=AuthorityFactory.DetectAuthorityFromUrl(authorityUrl);switch(type){case Authority_1.AuthorityType.B2C:return new B2cAuthority_1.B2cAuthority(authorityUrl,validateAuthority);case Authority_1.AuthorityType.Aad:return new AadAuthority_1.AadAuthority(authorityUrl,validateAuthority);default:throw ErrorMessage_1.ErrorMessage.invalidAuthorityType}};return AuthorityFactory}();exports.AuthorityFactory=AuthorityFactory},{"./AadAuthority":24,"./Authority":29,"./B2cAuthority":31,"./ErrorMessage":34,"./Utils":41}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var AadAuthority_1=require("./AadAuthority");var Authority_1=require("./Authority");var ErrorMessage_1=require("./ErrorMessage");var Utils_1=require("./Utils");var B2cAuthority=function(_super){tslib_1.__extends(B2cAuthority,_super);function B2cAuthority(authority,validateAuthority){var _this=_super.call(this,authority,validateAuthority)||this;var urlComponents=Utils_1.Utils.GetUrlComponents(authority);var pathSegments=urlComponents.PathSegments;if(pathSegments.length<3){throw ErrorMessage_1.ErrorMessage.b2cAuthorityUriInvalidPath}_this.CanonicalAuthority="https://"+urlComponents.HostNameAndPort+"/"+pathSegments[0]+"/"+pathSegments[1]+"/"+pathSegments[2]+"/";return _this}Object.defineProperty(B2cAuthority.prototype,"AuthorityType",{get:function(){return Authority_1.AuthorityType.B2C},enumerable:true,configurable:true});B2cAuthority.prototype.GetOpenIdConfigurationEndpointAsync=function(){var _this=this;var resultPromise=new Promise(function(resolve,reject){return resolve(_this.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled){return resultPromise}if(this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)){return resultPromise}return new Promise(function(resolve,reject){return reject(ErrorMessage_1.ErrorMessage.unsupportedAuthorityValidation)})};return B2cAuthority}(AadAuthority_1.AadAuthority);exports.B2cAuthority=B2cAuthority},{"./AadAuthority":24,"./Authority":29,"./ErrorMessage":34,"./Utils":41,tslib:44}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var ClientInfo=function(){function ClientInfo(rawClientInfo){if(!rawClientInfo||Utils_1.Utils.isEmpty(rawClientInfo)){this.uid="";this.utid="";return}try{var decodedClientInfo=Utils_1.Utils.base64DecodeStringUrlSafe(rawClientInfo);var clientInfo=JSON.parse(decodedClientInfo);if(clientInfo){if(clientInfo.hasOwnProperty("uid")){this.uid=clientInfo.uid}if(clientInfo.hasOwnProperty("utid")){this.utid=clientInfo.utid}}}catch(e){throw new Error(e)}}Object.defineProperty(ClientInfo.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(uid){this._uid=uid},enumerable:true,configurable:true});Object.defineProperty(ClientInfo.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(utid){this._utid=utid},enumerable:true,configurable:true});return ClientInfo}();exports.ClientInfo=ClientInfo},{"./Utils":41}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Constants=function(){function Constants(){}Object.defineProperty(Constants,"errorDescription",{get:function(){return"error_description"},enumerable:true,configurable:true});Object.defineProperty(Constants,"error",{get:function(){return"error"},enumerable:true,configurable:true});Object.defineProperty(Constants,"scope",{get:function(){return"scope"},enumerable:true,configurable:true});Object.defineProperty(Constants,"acquireTokenUser",{get:function(){return"msal.acquireTokenUser"},enumerable:true,configurable:true});Object.defineProperty(Constants,"clientInfo",{get:function(){return"client_info"},enumerable:true,configurable:true});Object.defineProperty(Constants,"clientId",{get:function(){return"clientId"},enumerable:true,configurable:true});Object.defineProperty(Constants,"authority",{get:function(){return"msal.authority"},enumerable:true,configurable:true});Object.defineProperty(Constants,"idToken",{get:function(){return"id_token"},enumerable:true,configurable:true});Object.defineProperty(Constants,"accessToken",{get:function(){return"access_token"},enumerable:true,configurable:true});Object.defineProperty(Constants,"expiresIn",{get:function(){return"expires_in"},enumerable:true,configurable:true});Object.defineProperty(Constants,"sessionState",{get:function(){return"session_state"},enumerable:true,configurable:true});Object.defineProperty(Constants,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:true,configurable:true});Object.defineProperty(Constants,"msalError",{get:function(){return"msal.error"},enumerable:true,configurable:true});Object.defineProperty(Constants,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:true,configurable:true});Object.defineProperty(Constants,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:true,configurable:true});Object.defineProperty(Constants,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:true,configurable:true});Object.defineProperty(Constants,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:true,configurable:true});Object.defineProperty(Constants,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:true,configurable:true});Object.defineProperty(Constants,"stateLogin",{get:function(){return"msal.state.login"},enumerable:true,configurable:true});Object.defineProperty(Constants,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:true,configurable:true});Object.defineProperty(Constants,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:true,configurable:true});Object.defineProperty(Constants,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:true,configurable:true});Object.defineProperty(Constants,"userName",{get:function(){return"msal.username"},enumerable:true,configurable:true});Object.defineProperty(Constants,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:true,configurable:true});Object.defineProperty(Constants,"loginRequest",{get:function(){return"msal.login.request"},enumerable:true,configurable:true});Object.defineProperty(Constants,"loginError",{get:function(){return"msal.login.error"},enumerable:true,configurable:true});Object.defineProperty(Constants,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:true,configurable:true});Object.defineProperty(Constants,"msal",{get:function(){return"msal"},enumerable:true,configurable:true});Object.defineProperty(Constants,"no_user",{get:function(){return"NO_USER"},enumerable:true,configurable:true});Object.defineProperty(Constants,"login_hint",{get:function(){return"login_hint"},enumerable:true,configurable:true});Object.defineProperty(Constants,"domain_hint",{get:function(){return"domain_hint"},enumerable:true,configurable:true});Object.defineProperty(Constants,"sid",{get:function(){return"sid"},enumerable:true,configurable:true});Object.defineProperty(Constants,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:true,configurable:true});Object.defineProperty(Constants,"prompt_none",{get:function(){return"&prompt=none"},enumerable:true,configurable:true});Object.defineProperty(Constants,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:true,configurable:true});Object.defineProperty(Constants,"resourceDelimeter",{get:function(){return"|"},enumerable:true,configurable:true});Object.defineProperty(Constants,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:true,configurable:true});Object.defineProperty(Constants,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:true,configurable:true});Object.defineProperty(Constants,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:true,configurable:true});Object.defineProperty(Constants,"popUpWidth",{get:function(){return this._popUpWidth},set:function(width){this._popUpWidth=width},enumerable:true,configurable:true});Object.defineProperty(Constants,"popUpHeight",{get:function(){return this._popUpHeight},set:function(height){this._popUpHeight=height},enumerable:true,configurable:true});Object.defineProperty(Constants,"login",{get:function(){return"LOGIN"},enumerable:true,configurable:true});Object.defineProperty(Constants,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:true,configurable:true});Object.defineProperty(Constants,"unknown",{get:function(){return"UNKNOWN"},enumerable:true,configurable:true});Object.defineProperty(Constants,"urlHash",{get:function(){return"msal.urlHash"},enumerable:true,configurable:true});Object.defineProperty(Constants,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:true,configurable:true});Object.defineProperty(Constants,"userIdentifier",{get:function(){return"userIdentifier"},enumerable:true,configurable:true});Constants._popUpWidth=483;Constants._popUpHeight=600;return Constants}();exports.Constants=Constants;var ErrorCodes=function(){function ErrorCodes(){}Object.defineProperty(ErrorCodes,"loginProgressError",{get:function(){return"login_progress_error"},enumerable:true,configurable:true});Object.defineProperty(ErrorCodes,"acquireTokenProgressError",{get:function(){return"acquiretoken_progress_error"},enumerable:true,configurable:true});Object.defineProperty(ErrorCodes,"inputScopesError",{get:function(){return"input_scopes_error"},enumerable:true,configurable:true});Object.defineProperty(ErrorCodes,"endpointResolutionError",{get:function(){return"endpoints_resolution_error"},enumerable:true,configurable:true});Object.defineProperty(ErrorCodes,"popUpWindowError",{get:function(){return"popup_window_error"},enumerable:true,configurable:true});Object.defineProperty(ErrorCodes,"userLoginError",{get:function(){return"user_login_error"},enumerable:true,configurable:true});Object.defineProperty(ErrorCodes,"userCancelledError",{get:function(){return"user_cancelled"},enumerable:true,configurable:true});return ErrorCodes}();exports.ErrorCodes=ErrorCodes;var ErrorDescription=function(){function ErrorDescription(){}Object.defineProperty(ErrorDescription,"loginProgressError",{get:function(){return"Login is in progress"},enumerable:true,configurable:true});Object.defineProperty(ErrorDescription,"acquireTokenProgressError",{get:function(){return"Acquire token is in progress"},enumerable:true,configurable:true});Object.defineProperty(ErrorDescription,"inputScopesError",{get:function(){return"Invalid value of input scopes provided"},enumerable:true,configurable:true});Object.defineProperty(ErrorDescription,"endpointResolutionError",{get:function(){return"Endpoints cannot be resolved"},enumerable:true,configurable:true});Object.defineProperty(ErrorDescription,"popUpWindowError",{get:function(){return"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},enumerable:true,configurable:true});Object.defineProperty(ErrorDescription,"userLoginError",{get:function(){return"User login is required"},enumerable:true,configurable:true});Object.defineProperty(ErrorDescription,"userCancelledError",{get:function(){return"User closed the popup window and cancelled the flow"},enumerable:true,configurable:true});return ErrorDescription}();exports.ErrorDescription=ErrorDescription},{}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ErrorMessage=function(){function ErrorMessage(){}Object.defineProperty(ErrorMessage,"authorityUriInvalidPath",{get:function(){return"AuthorityUriInvalidPath"},enumerable:true,configurable:true});Object.defineProperty(ErrorMessage,"authorityUriInsecure",{get:function(){return"AuthorityUriInsecure"},enumerable:true,configurable:true});Object.defineProperty(ErrorMessage,"invalidAuthorityType",{get:function(){return"InvalidAuthorityType"},enumerable:true,configurable:true});Object.defineProperty(ErrorMessage,"unsupportedAuthorityValidation",{get:function(){return"UnsupportedAuthorityValidation"},enumerable:true,configurable:true});Object.defineProperty(ErrorMessage,"b2cAuthorityUriInvalidPath",{get:function(){return"B2cAuthorityUriInvalidPath"},enumerable:true,configurable:true});return ErrorMessage}();exports.ErrorMessage=ErrorMessage},{}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var IdToken=function(){function IdToken(rawIdToken){if(Utils_1.Utils.isEmpty(rawIdToken)){throw new Error("null or empty raw idtoken")}try{this.rawIdToken=rawIdToken;this.decodedIdToken=Utils_1.Utils.extractIdToken(rawIdToken);if(this.decodedIdToken){if(this.decodedIdToken.hasOwnProperty("iss")){this.issuer=this.decodedIdToken["iss"]}if(this.decodedIdToken.hasOwnProperty("oid")){this.objectId=this.decodedIdToken["oid"]}if(this.decodedIdToken.hasOwnProperty("sub")){this.subject=this.decodedIdToken["sub"]}if(this.decodedIdToken.hasOwnProperty("tid")){this.tenantId=this.decodedIdToken["tid"]}if(this.decodedIdToken.hasOwnProperty("ver")){this.version=this.decodedIdToken["ver"]}if(this.decodedIdToken.hasOwnProperty("preferred_username")){this.preferredName=this.decodedIdToken["preferred_username"]}if(this.decodedIdToken.hasOwnProperty("name")){this.name=this.decodedIdToken["name"]}if(this.decodedIdToken.hasOwnProperty("nonce")){this.nonce=this.decodedIdToken["nonce"]}if(this.decodedIdToken.hasOwnProperty("exp")){this.expiration=this.decodedIdToken["exp"]}if(this.decodedIdToken.hasOwnProperty("home_oid")){this.homeObjectId=this.decodedIdToken["home_oid"]}if(this.decodedIdToken.hasOwnProperty("sid")){this.sid=this.decodedIdToken["sid"]}}}catch(e){throw new Error("Failed to parse the returned id token")}}return IdToken}();exports.IdToken=IdToken},{"./Utils":41}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var LogLevel;(function(LogLevel){LogLevel[LogLevel["Error"]=0]="Error";LogLevel[LogLevel["Warning"]=1]="Warning";LogLevel[LogLevel["Info"]=2]="Info";LogLevel[LogLevel["Verbose"]=3]="Verbose"})(LogLevel=exports.LogLevel||(exports.LogLevel={}));var Logger=function(){function Logger(localCallback,options){if(options===void 0){options={}}this._level=LogLevel.Info;var _a=options.correlationId,correlationId=_a===void 0?"":_a,_b=options.level,level=_b===void 0?LogLevel.Info:_b,_c=options.piiLoggingEnabled,piiLoggingEnabled=_c===void 0?false:_c;this._localCallback=localCallback;this._correlationId=correlationId;this._level=level;this._piiLoggingEnabled=piiLoggingEnabled}Logger.prototype.logMessage=function(logLevel,logMessage,containsPii){if(logLevel>this._level||!this._piiLoggingEnabled&&containsPii){return}var timestamp=(new Date).toUTCString();var log;if(!Utils_1.Utils.isEmpty(this._correlationId)){log=timestamp+":"+this._correlationId+"-"+Utils_1.Utils.getLibraryVersion()+"-"+LogLevel[logLevel]+" "+logMessage}else{log=timestamp+":"+Utils_1.Utils.getLibraryVersion()+"-"+LogLevel[logLevel]+" "+logMessage}this.executeCallback(logLevel,log,containsPii)};Logger.prototype.executeCallback=function(level,message,containsPii){if(this._localCallback){this._localCallback(level,message,containsPii)}};Logger.prototype.error=function(message){this.logMessage(LogLevel.Error,message,false)};Logger.prototype.errorPii=function(message){this.logMessage(LogLevel.Error,message,true)};Logger.prototype.warning=function(message){this.logMessage(LogLevel.Warning,message,false)};Logger.prototype.warningPii=function(message){this.logMessage(LogLevel.Warning,message,true)};Logger.prototype.info=function(message){this.logMessage(LogLevel.Info,message,false)};Logger.prototype.infoPii=function(message){this.logMessage(LogLevel.Info,message,true)};Logger.prototype.verbose=function(message){this.logMessage(LogLevel.Verbose,message,false)};Logger.prototype.verbosePii=function(message){this.logMessage(LogLevel.Verbose,message,true)};return Logger}();exports.Logger=Logger},{"./Utils":41}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var TokenResponse=function(){function TokenResponse(){this.valid=false;this.parameters={};this.stateMatch=false;this.stateResponse="";this.requestType="unknown"}return TokenResponse}();exports.TokenResponse=TokenResponse},{}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Constants_1=require("./Constants");var AccessTokenCacheItem_1=require("./AccessTokenCacheItem");var Storage=function(){function Storage(cacheLocation){if(Storage._instance){return Storage._instance}this._cacheLocation=cacheLocation;this._localStorageSupported=typeof window[this._cacheLocation]!=="undefined"&&window[this._cacheLocation]!=null;this._sessionStorageSupported=typeof window[cacheLocation]!=="undefined"&&window[cacheLocation]!=null;Storage._instance=this;if(!this._localStorageSupported&&!this._sessionStorageSupported){throw new Error("localStorage and sessionStorage not supported")}return Storage._instance}Storage.prototype.setItem=function(key,value,enableCookieStorage){if(window[this._cacheLocation]){window[this._cacheLocation].setItem(key,value)}if(enableCookieStorage){this.setItemCookie(key,value)}};Storage.prototype.getItem=function(key,enableCookieStorage){if(enableCookieStorage&&this.getItemCookie(key)){return this.getItemCookie(key)}if(window[this._cacheLocation]){return window[this._cacheLocation].getItem(key)}};Storage.prototype.removeItem=function(key){if(window[this._cacheLocation]){return window[this._cacheLocation].removeItem(key)}};Storage.prototype.clear=function(){if(window[this._cacheLocation]){return window[this._cacheLocation].clear()}};Storage.prototype.getAllAccessTokens=function(clientId,userIdentifier){var results=[];var accessTokenCacheItem;var storage=window[this._cacheLocation];if(storage){var key=void 0;for(key in storage){if(storage.hasOwnProperty(key)){if(key.match(clientId)&&key.match(userIdentifier)){var value=this.getItem(key);if(value){accessTokenCacheItem=new AccessTokenCacheItem_1.AccessTokenCacheItem(JSON.parse(key),JSON.parse(value));results.push(accessTokenCacheItem)}}}}}return results};Storage.prototype.removeAcquireTokenEntries=function(authorityKey,acquireTokenUserKey){var storage=window[this._cacheLocation];if(storage){var key=void 0;for(key in storage){if(storage.hasOwnProperty(key)){if(authorityKey!=""&&key.indexOf(authorityKey)>-1||acquireTokenUserKey!=""&&key.indexOf(acquireTokenUserKey)>-1){this.removeItem(key)}}}}};Storage.prototype.resetCacheItems=function(){var storage=window[this._cacheLocation];if(storage){var key=void 0;for(key in storage){if(storage.hasOwnProperty(key)&&key.indexOf(Constants_1.Constants.msal)!==-1){this.setItem(key,"")}if(storage.hasOwnProperty(key)&&key.indexOf(Constants_1.Constants.renewStatus)!==-1)this.removeItem(key)}}};Storage.prototype.setItemCookie=function(cName,cValue,expires){var cookieStr=cName+"="+cValue+";";if(expires){var expireTime=this.setExpirationCookie(expires);cookieStr+="expires="+expireTime+";"}document.cookie=cookieStr};Storage.prototype.getItemCookie=function(cName){var name=cName+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1)}if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}return""};Storage.prototype.setExpirationCookie=function(cookieLife){var today=new Date;var expr=new Date(today.getTime()+cookieLife*24*60*60*1e3);return expr.toUTCString()};Storage.prototype.clearCookie=function(){this.setItemCookie(Constants_1.Constants.nonceIdToken,"",-1);this.setItemCookie(Constants_1.Constants.stateLogin,"",-1);this.setItemCookie(Constants_1.Constants.loginRequest,"",-1);this.setItemCookie(Constants_1.Constants.stateAcquireToken,"",-1)};return Storage}();exports.Storage=Storage},{"./AccessTokenCacheItem":25,"./Constants":33}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./Utils");var User=function(){function User(displayableId,name,identityProvider,userIdentifier,idToken,sid){this.displayableId=displayableId;this.name=name;this.identityProvider=identityProvider;this.userIdentifier=userIdentifier;this.idToken=idToken;this.sid=sid}User.createUser=function(idToken,clientInfo,authority){var uid;var utid;if(!clientInfo){uid="";utid=""}else{uid=clientInfo.uid;utid=clientInfo.utid}var userIdentifier=Utils_1.Utils.base64EncodeStringUrlSafe(uid)+"."+Utils_1.Utils.base64EncodeStringUrlSafe(utid);return new User(idToken.preferredName,idToken.name,idToken.issuer,userIdentifier,idToken.decodedIdToken,idToken.sid)};return User}();exports.User=User},{"./Utils":41}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var AccessTokenKey_1=require("./AccessTokenKey");var AccessTokenValue_1=require("./AccessTokenValue");var AuthenticationRequestParameters_1=require("./AuthenticationRequestParameters");var ClientInfo_1=require("./ClientInfo");var Constants_1=require("./Constants");var IdToken_1=require("./IdToken");var Logger_1=require("./Logger");var Storage_1=require("./Storage");var RequestInfo_1=require("./RequestInfo");var User_1=require("./User");var Utils_1=require("./Utils");var AuthorityFactory_1=require("./AuthorityFactory");var ResponseTypes={id_token:"id_token",token:"token",id_token_token:"id_token token"};var resolveTokenOnlyIfOutOfIframe=function(target,propertyKey,descriptor){var tokenAcquisitionMethod=descriptor.value;descriptor.value=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}return this.isInIframe()?new Promise(function(){}):tokenAcquisitionMethod.apply(this,args)};return descriptor};var UserAgentApplication=function(){function UserAgentApplication(clientId,authority,tokenReceivedCallback,options){if(options===void 0){options={}}this._cacheLocations={localStorage:"localStorage",sessionStorage:"sessionStorage"};this._clockSkew=300;this._tokenReceivedCallback=null;this._isAngular=false;var _a=options.validateAuthority,validateAuthority=_a===void 0?true:_a,_b=options.cacheLocation,cacheLocation=_b===void 0?"sessionStorage":_b,_c=options.redirectUri,redirectUri=_c===void 0?window.location.href.split("?")[0].split("#")[0]:_c,_d=options.postLogoutRedirectUri,postLogoutRedirectUri=_d===void 0?window.location.href.split("?")[0].split("#")[0]:_d,_e=options.logger,logger=_e===void 0?new Logger_1.Logger(null):_e,_f=options.loadFrameTimeout,loadFrameTimeout=_f===void 0?6e3:_f,_g=options.navigateToLoginRequestUrl,navigateToLoginRequestUrl=_g===void 0?true:_g,_h=options.state,state=_h===void 0?"":_h,_j=options.isAngular,isAngular=_j===void 0?false:_j,_k=options.unprotectedResources,unprotectedResources=_k===void 0?new Array:_k,_l=options.protectedResourceMap,protectedResourceMap=_l===void 0?new Map:_l,_m=options.storeAuthStateInCookie,storeAuthStateInCookie=_m===void 0?false:_m;this.loadFrameTimeout=loadFrameTimeout;this.clientId=clientId;this.validateAuthority=validateAuthority;this.authority=authority||"https://login.microsoftonline.com/common";this._tokenReceivedCallback=tokenReceivedCallback;this._redirectUri=redirectUri;this._postLogoutredirectUri=postLogoutRedirectUri;this._loginInProgress=false;this._acquireTokenInProgress=false;this._cacheLocation=cacheLocation;this._navigateToLoginRequestUrl=navigateToLoginRequestUrl;this._state=state;this._isAngular=isAngular;this._unprotectedResources=unprotectedResources;this._protectedResourceMap=protectedResourceMap;if(!this._cacheLocations[cacheLocation]){throw new Error("Cache Location is not valid. Provided value:"+this._cacheLocation+".Possible values are: "+this._cacheLocations.localStorage+", "+this._cacheLocations.sessionStorage)}this._cacheStorage=new Storage_1.Storage(this._cacheLocation);this._logger=logger;this.storeAuthStateInCookie=storeAuthStateInCookie;window.openedWindows=[];window.activeRenewals={};window.renewStates=[];window.callBackMappedToRenewStates={};window.callBacksMappedToRenewStates={};window.msal=this;var urlHash=window.location.hash;var isCallback=this.isCallback(urlHash);if(!this._isAngular){if(isCallback){this.handleAuthenticationResponse.call(this,urlHash)}else{var pendingCallback=this._cacheStorage.getItem(Constants_1.Constants.urlHash);if(pendingCallback){this.processCallBack(pendingCallback)}}}}Object.defineProperty(UserAgentApplication.prototype,"cacheLocation",{get:function(){return this._cacheLocation},enumerable:true,configurable:true});Object.defineProperty(UserAgentApplication.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(val){this.authorityInstance=AuthorityFactory_1.AuthorityFactory.CreateInstance(val,this.validateAuthority)},enumerable:true,configurable:true});UserAgentApplication.prototype.processCallBack=function(hash){this._logger.info("Processing the callback from redirect response");var requestInfo=this.getRequestInfo(hash);this.saveTokenFromHash(requestInfo);var token=requestInfo.parameters[Constants_1.Constants.accessToken]||requestInfo.parameters[Constants_1.Constants.idToken];var errorDesc=requestInfo.parameters[Constants_1.Constants.errorDescription];var error=requestInfo.parameters[Constants_1.Constants.error];var tokenType;if(requestInfo.parameters[Constants_1.Constants.accessToken]){tokenType=Constants_1.Constants.accessToken}else{tokenType=Constants_1.Constants.idToken}this._cacheStorage.removeItem(Constants_1.Constants.urlHash);try{if(this._tokenReceivedCallback){this._cacheStorage.clearCookie();this._tokenReceivedCallback.call(this,errorDesc,token,error,tokenType,this.getUserState(this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)))}}catch(err){this._logger.error("Error occurred in token received callback function: "+err)}};UserAgentApplication.prototype.loginRedirect=function(scopes,extraQueryParameters){var _this=this;if(this._loginInProgress){if(this._tokenReceivedCallback){this._tokenReceivedCallback(Constants_1.ErrorDescription.loginProgressError,null,Constants_1.ErrorCodes.loginProgressError,Constants_1.Constants.idToken,this.getUserState(this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)));return}}if(scopes){var isValidScope=this.validateInputScope(scopes);if(isValidScope&&!Utils_1.Utils.isEmpty(isValidScope)){if(this._tokenReceivedCallback){this._tokenReceivedCallback(Constants_1.ErrorDescription.inputScopesError,null,Constants_1.ErrorCodes.inputScopesError,Constants_1.Constants.idToken,this.getUserState(this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)));return}}scopes=this.filterScopes(scopes)}this._loginInProgress=true;this.authorityInstance.ResolveEndpointsAsync().then(function(){var authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(_this.authorityInstance,_this.clientId,scopes,ResponseTypes.id_token,_this._redirectUri,_this._state);if(extraQueryParameters){authenticationRequest.extraQueryParameters=extraQueryParameters}var loginStartPage=_this._cacheStorage.getItem(Constants_1.Constants.angularLoginRequest);if(!loginStartPage||loginStartPage===""){loginStartPage=window.location.href}else{_this._cacheStorage.setItem(Constants_1.Constants.angularLoginRequest,"")}_this._cacheStorage.setItem(Constants_1.Constants.loginRequest,loginStartPage,_this.storeAuthStateInCookie);_this._cacheStorage.setItem(Constants_1.Constants.loginError,"");_this._cacheStorage.setItem(Constants_1.Constants.stateLogin,authenticationRequest.state,_this.storeAuthStateInCookie);_this._cacheStorage.setItem(Constants_1.Constants.nonceIdToken,authenticationRequest.nonce,_this.storeAuthStateInCookie);_this._cacheStorage.setItem(Constants_1.Constants.msalError,"");_this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,"");var authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+authenticationRequest.state;if(Utils_1.Utils.isEmpty(_this._cacheStorage.getItem(authorityKey))){_this._cacheStorage.setItem(authorityKey,_this.authority)}var urlNavigate=authenticationRequest.createNavigateUrl(scopes)+Constants_1.Constants.prompt_select_account+Constants_1.Constants.response_mode_fragment;_this.promptUser(urlNavigate)})};UserAgentApplication.prototype.loginPopup=function(scopes,extraQueryParameters){var _this=this;return new Promise(function(resolve,reject){if(_this._loginInProgress){reject(Constants_1.ErrorCodes.loginProgressError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.loginProgressError);return}if(scopes){var isValidScope=_this.validateInputScope(scopes);if(isValidScope&&!Utils_1.Utils.isEmpty(isValidScope)){reject(Constants_1.ErrorCodes.inputScopesError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.inputScopesError);return}scopes=_this.filterScopes(scopes)}else{scopes=[_this.clientId]}var scope=scopes.join(" ").toLowerCase();var popUpWindow=_this.openWindow("about:blank","_blank",1,_this,resolve,reject);if(!popUpWindow){return}_this._loginInProgress=true;_this.authorityInstance.ResolveEndpointsAsync().then(function(){var authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(_this.authorityInstance,_this.clientId,scopes,ResponseTypes.id_token,_this._redirectUri,_this._state);if(extraQueryParameters){authenticationRequest.extraQueryParameters=extraQueryParameters}_this._cacheStorage.setItem(Constants_1.Constants.loginRequest,window.location.href,_this.storeAuthStateInCookie);_this._cacheStorage.setItem(Constants_1.Constants.loginError,"");_this._cacheStorage.setItem(Constants_1.Constants.nonceIdToken,authenticationRequest.nonce,_this.storeAuthStateInCookie);_this._cacheStorage.setItem(Constants_1.Constants.msalError,"");_this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,"");var authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+authenticationRequest.state;if(Utils_1.Utils.isEmpty(_this._cacheStorage.getItem(authorityKey))){_this._cacheStorage.setItem(authorityKey,_this.authority)}var urlNavigate=authenticationRequest.createNavigateUrl(scopes)+Constants_1.Constants.prompt_select_account+Constants_1.Constants.response_mode_fragment;window.renewStates.push(authenticationRequest.state);window.requestType=Constants_1.Constants.login;_this.registerCallback(authenticationRequest.state,scope,resolve,reject);if(popUpWindow){_this._logger.infoPii("Navigated Popup window to:"+urlNavigate);popUpWindow.location.href=urlNavigate}},function(){_this._logger.info(Constants_1.ErrorCodes.endpointResolutionError+":"+Constants_1.ErrorDescription.endpointResolutionError);_this._cacheStorage.setItem(Constants_1.Constants.msalError,Constants_1.ErrorCodes.endpointResolutionError);_this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,Constants_1.ErrorDescription.endpointResolutionError);if(reject){reject(Constants_1.ErrorCodes.endpointResolutionError+":"+Constants_1.ErrorDescription.endpointResolutionError)}if(popUpWindow){popUpWindow.close()}}).catch(function(err){_this._logger.warning("could not resolve endpoints");reject(err)})})};UserAgentApplication.prototype.promptUser=function(urlNavigate){if(urlNavigate&&!Utils_1.Utils.isEmpty(urlNavigate)){this._logger.infoPii("Navigate to:"+urlNavigate);window.location.replace(urlNavigate)}else{this._logger.info("Navigate url is empty")}};UserAgentApplication.prototype.openWindow=function(urlNavigate,title,interval,instance,resolve,reject){var _this=this;var popupWindow=this.openPopup(urlNavigate,title,Constants_1.Constants.popUpWidth,Constants_1.Constants.popUpHeight);if(popupWindow==null){instance._loginInProgress=false;instance._acquireTokenInProgress=false;this._logger.info(Constants_1.ErrorCodes.popUpWindowError+":"+Constants_1.ErrorDescription.popUpWindowError);this._cacheStorage.setItem(Constants_1.Constants.msalError,Constants_1.ErrorCodes.popUpWindowError);this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,Constants_1.ErrorDescription.popUpWindowError);if(reject){reject(Constants_1.ErrorCodes.popUpWindowError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.popUpWindowError)}return null}window.openedWindows.push(popupWindow);var pollTimer=window.setInterval(function(){if(popupWindow&&popupWindow.closed&&instance._loginInProgress){if(reject){reject(Constants_1.ErrorCodes.userCancelledError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.userCancelledError)}window.clearInterval(pollTimer);if(_this._isAngular){_this.broadcast("msal:popUpClosed",Constants_1.ErrorCodes.userCancelledError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.userCancelledError);return}instance._loginInProgress=false;instance._acquireTokenInProgress=false}try{var popUpWindowLocation=popupWindow.location;if(popUpWindowLocation.href.indexOf(_this._redirectUri)!==-1){window.clearInterval(pollTimer);instance._loginInProgress=false;instance._acquireTokenInProgress=false;_this._logger.info("Closing popup window");if(_this._isAngular){_this.broadcast("msal:popUpHashChanged",popUpWindowLocation.hash);for(var i=0;i<window.openedWindows.length;i++){window.openedWindows[i].close()}}}}catch(e){}},interval);return popupWindow};UserAgentApplication.prototype.broadcast=function(eventName,data){var evt=new CustomEvent(eventName,{detail:data});window.dispatchEvent(evt)};UserAgentApplication.prototype.logout=function(){this.clearCache();this._user=null;var logout="";if(this._postLogoutredirectUri){logout="post_logout_redirect_uri="+encodeURIComponent(this._postLogoutredirectUri)}var urlNavigate=this.authority+"/oauth2/v2.0/logout?"+logout;this.promptUser(urlNavigate)};UserAgentApplication.prototype.clearCache=function(){window.renewStates=[];var accessTokenItems=this._cacheStorage.getAllAccessTokens(Constants_1.Constants.clientId,Constants_1.Constants.userIdentifier);for(var i=0;i<accessTokenItems.length;i++){this._cacheStorage.removeItem(JSON.stringify(accessTokenItems[i].key))}this._cacheStorage.resetCacheItems();this._cacheStorage.clearCookie()};UserAgentApplication.prototype.clearCacheForScope=function(accessToken){var accessTokenItems=this._cacheStorage.getAllAccessTokens(Constants_1.Constants.clientId,Constants_1.Constants.userIdentifier);for(var i=0;i<accessTokenItems.length;i++){var token=accessTokenItems[i];if(token.value.accessToken==accessToken){this._cacheStorage.removeItem(JSON.stringify(token.key))}}};UserAgentApplication.prototype.openPopup=function(urlNavigate,title,popUpWidth,popUpHeight){try{var winLeft=window.screenLeft?window.screenLeft:window.screenX;var winTop=window.screenTop?window.screenTop:window.screenY;var width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var left=width/2-popUpWidth/2+winLeft;var top_1=height/2-popUpHeight/2+winTop;var popupWindow=window.open(urlNavigate,title,"width="+popUpWidth+", height="+popUpHeight+", top="+top_1+", left="+left);if(popupWindow.focus){popupWindow.focus()}return popupWindow}catch(e){this._logger.error("error opening popup "+e.message);this._loginInProgress=false;this._acquireTokenInProgress=false;return null}};UserAgentApplication.prototype.validateInputScope=function(scopes){if(!scopes||scopes.length<1){return"Scopes cannot be passed as an empty array"}if(!Array.isArray(scopes)){throw new Error("API does not accept non-array scopes")}if(scopes.indexOf(this.clientId)>-1){if(scopes.length>1){return"ClientId can only be provided as a single scope"}}return""};UserAgentApplication.prototype.filterScopes=function(scopes){scopes=scopes.filter(function(element){return element!=="openid"});scopes=scopes.filter(function(element){return element!=="profile"});return scopes};UserAgentApplication.prototype.registerCallback=function(expectedState,scope,resolve,reject){var _this=this;window.activeRenewals[scope]=expectedState;if(!window.callBacksMappedToRenewStates[expectedState]){window.callBacksMappedToRenewStates[expectedState]=[]}window.callBacksMappedToRenewStates[expectedState].push({resolve:resolve,reject:reject});if(!window.callBackMappedToRenewStates[expectedState]){window.callBackMappedToRenewStates[expectedState]=function(errorDesc,token,error,tokenType){window.activeRenewals[scope]=null;for(var i=0;i<window.callBacksMappedToRenewStates[expectedState].length;++i){try{if(errorDesc||error){window.callBacksMappedToRenewStates[expectedState][i].reject(errorDesc+Constants_1.Constants.resourceDelimeter+error)}else if(token){window.callBacksMappedToRenewStates[expectedState][i].resolve(token)}}catch(e){_this._logger.warning(e)}}window.callBacksMappedToRenewStates[expectedState]=null;window.callBackMappedToRenewStates[expectedState]=null}}};UserAgentApplication.prototype.getCachedTokenInternal=function(scopes,user){var userObject=user?user:this.getUser();if(!userObject){return}var authenticationRequest;var newAuthority=this.authorityInstance?this.authorityInstance:AuthorityFactory_1.AuthorityFactory.CreateInstance(this.authority,this.validateAuthority);if(Utils_1.Utils.compareObjects(userObject,this.getUser())){if(scopes.indexOf(this.clientId)>-1){authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(newAuthority,this.clientId,scopes,ResponseTypes.id_token,this._redirectUri,this._state)}else{authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(newAuthority,this.clientId,scopes,ResponseTypes.token,this._redirectUri,this._state)}}else{authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(newAuthority,this.clientId,scopes,ResponseTypes.id_token_token,this._redirectUri,this._state)}return this.getCachedToken(authenticationRequest,user)};UserAgentApplication.prototype.getCachedToken=function(authenticationRequest,user){var accessTokenCacheItem=null;var scopes=authenticationRequest.scopes;var tokenCacheItems=this._cacheStorage.getAllAccessTokens(this.clientId,user?user.userIdentifier:null);if(tokenCacheItems.length===0){return null}var filteredItems=[];if(!authenticationRequest.authority){for(var i=0;i<tokenCacheItems.length;i++){var cacheItem=tokenCacheItems[i];var cachedScopes=cacheItem.key.scopes.split(" ");if(Utils_1.Utils.containsScope(cachedScopes,scopes)){filteredItems.push(cacheItem)}}if(filteredItems.length===1){accessTokenCacheItem=filteredItems[0];authenticationRequest.authorityInstance=AuthorityFactory_1.AuthorityFactory.CreateInstance(accessTokenCacheItem.key.authority,this.validateAuthority)}else if(filteredItems.length>1){return{errorDesc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"}}else{var authorityList=this.getUniqueAuthority(tokenCacheItems,"authority");if(authorityList.length>1){return{errorDesc:"Multiple authorities found in the cache. Pass authority in the API overload.",token:null,error:"multiple_matching_tokens_detected"}}authenticationRequest.authorityInstance=AuthorityFactory_1.AuthorityFactory.CreateInstance(authorityList[0],this.validateAuthority)}}else{for(var i=0;i<tokenCacheItems.length;i++){var cacheItem=tokenCacheItems[i];var cachedScopes=cacheItem.key.scopes.split(" ");if(Utils_1.Utils.containsScope(cachedScopes,scopes)&&cacheItem.key.authority===authenticationRequest.authority){filteredItems.push(cacheItem)}}if(filteredItems.length===0){return null}else if(filteredItems.length===1){accessTokenCacheItem=filteredItems[0]}else{return{errorDesc:"The cache contains multiple tokens satisfying the requirements.Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"}}}if(accessTokenCacheItem!=null){var expired=Number(accessTokenCacheItem.value.expiresIn);var offset=this._clockSkew||300;if(expired&&expired>Utils_1.Utils.now()+offset){return{errorDesc:null,token:accessTokenCacheItem.value.accessToken,error:null}}else{this._cacheStorage.removeItem(JSON.stringify(filteredItems[0].key));return null}}else{return null}};UserAgentApplication.prototype.getAllUsers=function(){var users=[];var accessTokenCacheItems=this._cacheStorage.getAllAccessTokens(Constants_1.Constants.clientId,Constants_1.Constants.userIdentifier);for(var i=0;i<accessTokenCacheItems.length;i++){var idToken=new IdToken_1.IdToken(accessTokenCacheItems[i].value.idToken);var clientInfo=new ClientInfo_1.ClientInfo(accessTokenCacheItems[i].value.clientInfo);var user=User_1.User.createUser(idToken,clientInfo,this.authority);users.push(user)}return this.getUniqueUsers(users)};UserAgentApplication.prototype.getUniqueUsers=function(users){if(!users||users.length<=1){return users}var flags=[];var uniqueUsers=[];for(var index=0;index<users.length;++index){if(users[index].userIdentifier&&flags.indexOf(users[index].userIdentifier)===-1){flags.push(users[index].userIdentifier);uniqueUsers.push(users[index])}}return uniqueUsers};UserAgentApplication.prototype.getUniqueAuthority=function(accessTokenCacheItems,property){var authorityList=[];var flags=[];accessTokenCacheItems.forEach(function(element){if(element.key.hasOwnProperty(property)&&flags.indexOf(element.key[property])===-1){flags.push(element.key[property]);authorityList.push(element.key[property])}});return authorityList};UserAgentApplication.prototype.addHintParameters=function(urlNavigate,user){var userObject=user?user:this.getUser();if(userObject){var decodedClientInfo=userObject.userIdentifier.split(".");var uid=Utils_1.Utils.base64DecodeStringUrlSafe(decodedClientInfo[0]);var utid=Utils_1.Utils.base64DecodeStringUrlSafe(decodedClientInfo[1]);if(userObject.sid&&urlNavigate.indexOf(Constants_1.Constants.prompt_none)!==-1){if(!this.urlContainsQueryStringParameter(Constants_1.Constants.sid,urlNavigate)&&!this.urlContainsQueryStringParameter(Constants_1.Constants.login_hint,urlNavigate)){urlNavigate+="&"+Constants_1.Constants.sid+"="+encodeURIComponent(this._user.sid)}}else{if(!this.urlContainsQueryStringParameter(Constants_1.Constants.login_hint,urlNavigate)&&userObject.displayableId&&!Utils_1.Utils.isEmpty(userObject.displayableId)){urlNavigate+="&"+Constants_1.Constants.login_hint+"="+encodeURIComponent(user.displayableId)}}if(!Utils_1.Utils.isEmpty(uid)&&!Utils_1.Utils.isEmpty(utid)){if(!this.urlContainsQueryStringParameter("domain_req",urlNavigate)&&!Utils_1.Utils.isEmpty(utid)){urlNavigate+="&domain_req="+encodeURIComponent(utid)}if(!this.urlContainsQueryStringParameter("login_req",urlNavigate)&&!Utils_1.Utils.isEmpty(uid)){urlNavigate+="&login_req="+encodeURIComponent(uid)}}if(!this.urlContainsQueryStringParameter(Constants_1.Constants.domain_hint,urlNavigate)&&!Utils_1.Utils.isEmpty(utid)){if(utid==="9188040d-6c67-4c5b-b112-36a304b66dad"){urlNavigate+="&"+Constants_1.Constants.domain_hint+"="+encodeURIComponent("consumers")}else{urlNavigate+="&"+Constants_1.Constants.domain_hint+"="+encodeURIComponent("organizations")}}}return urlNavigate};UserAgentApplication.prototype.urlContainsQueryStringParameter=function(name,url){var regex=new RegExp("[\\?&]"+name+"=");return regex.test(url)};UserAgentApplication.prototype.acquireTokenRedirect=function(scopes,authority,user,extraQueryParameters){var _this=this;var isValidScope=this.validateInputScope(scopes);if(isValidScope&&!Utils_1.Utils.isEmpty(isValidScope)){if(this._tokenReceivedCallback){this._tokenReceivedCallback(Constants_1.ErrorDescription.inputScopesError,null,Constants_1.ErrorCodes.inputScopesError,Constants_1.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)));return}}if(scopes){scopes=this.filterScopes(scopes)}var userObject=user?user:this.getUser();if(this._acquireTokenInProgress){return}var scope=scopes.join(" ").toLowerCase();if(!userObject&&!(extraQueryParameters&&extraQueryParameters.indexOf(Constants_1.Constants.login_hint)!==-1)){if(this._tokenReceivedCallback){this._logger.info("User login is required");this._tokenReceivedCallback(Constants_1.ErrorDescription.userLoginError,null,Constants_1.ErrorCodes.userLoginError,Constants_1.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)));return}}this._acquireTokenInProgress=true;var authenticationRequest;var acquireTokenAuthority=authority?AuthorityFactory_1.AuthorityFactory.CreateInstance(authority,this.validateAuthority):this.authorityInstance;acquireTokenAuthority.ResolveEndpointsAsync().then(function(){if(Utils_1.Utils.compareObjects(userObject,_this.getUser())){if(scopes.indexOf(_this.clientId)>-1){authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(acquireTokenAuthority,_this.clientId,scopes,ResponseTypes.id_token,_this._redirectUri,_this._state)}else{authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(acquireTokenAuthority,_this.clientId,scopes,ResponseTypes.token,_this._redirectUri,_this._state)}}else{authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(acquireTokenAuthority,_this.clientId,scopes,ResponseTypes.id_token_token,_this._redirectUri,_this._state)}_this._cacheStorage.setItem(Constants_1.Constants.nonceIdToken,authenticationRequest.nonce,_this.storeAuthStateInCookie);var acquireTokenUserKey;if(userObject){acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+userObject.userIdentifier+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}else{acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+Constants_1.Constants.no_user+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}if(Utils_1.Utils.isEmpty(_this._cacheStorage.getItem(acquireTokenUserKey))){_this._cacheStorage.setItem(acquireTokenUserKey,JSON.stringify(userObject))}var authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+authenticationRequest.state;if(Utils_1.Utils.isEmpty(_this._cacheStorage.getItem(authorityKey))){_this._cacheStorage.setItem(authorityKey,acquireTokenAuthority.CanonicalAuthority)}if(extraQueryParameters){authenticationRequest.extraQueryParameters=extraQueryParameters}var urlNavigate=authenticationRequest.createNavigateUrl(scopes)+Constants_1.Constants.prompt_select_account+Constants_1.Constants.response_mode_fragment;urlNavigate=_this.addHintParameters(urlNavigate,userObject);if(urlNavigate){_this._cacheStorage.setItem(Constants_1.Constants.stateAcquireToken,authenticationRequest.state,_this.storeAuthStateInCookie);window.location.replace(urlNavigate)}})};UserAgentApplication.prototype.acquireTokenPopup=function(scopes,authority,user,extraQueryParameters){var _this=this;return new Promise(function(resolve,reject){var isValidScope=_this.validateInputScope(scopes);if(isValidScope&&!Utils_1.Utils.isEmpty(isValidScope)){reject(Constants_1.ErrorCodes.inputScopesError+Constants_1.Constants.resourceDelimeter+isValidScope)}if(scopes){scopes=_this.filterScopes(scopes)}var userObject=user?user:_this.getUser();if(_this._acquireTokenInProgress){reject(Constants_1.ErrorCodes.acquireTokenProgressError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.acquireTokenProgressError);return}var scope=scopes.join(" ").toLowerCase();if(!userObject&&!(extraQueryParameters&&extraQueryParameters.indexOf(Constants_1.Constants.login_hint)!==-1)){_this._logger.info("User login is required");reject(Constants_1.ErrorCodes.userLoginError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.userLoginError);return}_this._acquireTokenInProgress=true;var authenticationRequest;var acquireTokenAuthority=authority?AuthorityFactory_1.AuthorityFactory.CreateInstance(authority,_this.validateAuthority):_this.authorityInstance;var popUpWindow=_this.openWindow("about:blank","_blank",1,_this,resolve,reject);if(!popUpWindow){return}acquireTokenAuthority.ResolveEndpointsAsync().then(function(){if(Utils_1.Utils.compareObjects(userObject,_this.getUser())){if(scopes.indexOf(_this.clientId)>-1){authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(acquireTokenAuthority,_this.clientId,scopes,ResponseTypes.id_token,_this._redirectUri,_this._state)}else{authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(acquireTokenAuthority,_this.clientId,scopes,ResponseTypes.token,_this._redirectUri,_this._state)}}else{authenticationRequest=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(acquireTokenAuthority,_this.clientId,scopes,ResponseTypes.id_token_token,_this._redirectUri,_this._state)}_this._cacheStorage.setItem(Constants_1.Constants.nonceIdToken,authenticationRequest.nonce);authenticationRequest.state=authenticationRequest.state;var acquireTokenUserKey;if(userObject){acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+userObject.userIdentifier+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}else{acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+Constants_1.Constants.no_user+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}if(Utils_1.Utils.isEmpty(_this._cacheStorage.getItem(acquireTokenUserKey))){_this._cacheStorage.setItem(acquireTokenUserKey,JSON.stringify(userObject))}var authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+authenticationRequest.state;if(Utils_1.Utils.isEmpty(_this._cacheStorage.getItem(authorityKey))){_this._cacheStorage.setItem(authorityKey,acquireTokenAuthority.CanonicalAuthority)}if(extraQueryParameters){authenticationRequest.extraQueryParameters=extraQueryParameters}var urlNavigate=authenticationRequest.createNavigateUrl(scopes)+Constants_1.Constants.prompt_select_account+Constants_1.Constants.response_mode_fragment;urlNavigate=_this.addHintParameters(urlNavigate,userObject);window.renewStates.push(authenticationRequest.state);window.requestType=Constants_1.Constants.renewToken;_this.registerCallback(authenticationRequest.state,scope,resolve,reject);if(popUpWindow){popUpWindow.location.href=urlNavigate}},function(){_this._logger.info(Constants_1.ErrorCodes.endpointResolutionError+":"+Constants_1.ErrorDescription.endpointResolutionError);_this._cacheStorage.setItem(Constants_1.Constants.msalError,Constants_1.ErrorCodes.endpointResolutionError);_this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,Constants_1.ErrorDescription.endpointResolutionError);if(reject){reject(Constants_1.ErrorCodes.endpointResolutionError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.endpointResolutionError)}if(popUpWindow){popUpWindow.close()}}).catch(function(err){_this._logger.warning("could not resolve endpoints");reject(err)})})};UserAgentApplication.prototype.acquireTokenSilent=function(scopes,authority,user,extraQueryParameters){var _this=this;return new Promise(function(resolve,reject){var isValidScope=_this.validateInputScope(scopes);if(isValidScope&&!Utils_1.Utils.isEmpty(isValidScope)){reject(Constants_1.ErrorCodes.inputScopesError+"|"+isValidScope)}else{if(scopes){scopes=_this.filterScopes(scopes)}var scope_1=scopes.join(" ").toLowerCase();var userObject_1=user?user:_this.getUser();if(!userObject_1&&!(extraQueryParameters&&(extraQueryParameters.indexOf(Constants_1.Constants.login_hint)!==-1||extraQueryParameters.indexOf(Constants_1.Constants.sid)!==-1))){_this._logger.info("User login is required");reject(Constants_1.ErrorCodes.userLoginError+Constants_1.Constants.resourceDelimeter+Constants_1.ErrorDescription.userLoginError);return}var authenticationRequest_1;var newAuthority=authority?AuthorityFactory_1.AuthorityFactory.CreateInstance(authority,_this.validateAuthority):_this.authorityInstance;if(Utils_1.Utils.compareObjects(userObject_1,_this.getUser())){if(scopes.indexOf(_this.clientId)>-1){authenticationRequest_1=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(newAuthority,_this.clientId,scopes,ResponseTypes.id_token,_this._redirectUri,_this._state)}else{authenticationRequest_1=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(newAuthority,_this.clientId,scopes,ResponseTypes.token,_this._redirectUri,_this._state)}}else{authenticationRequest_1=new AuthenticationRequestParameters_1.AuthenticationRequestParameters(newAuthority,_this.clientId,scopes,ResponseTypes.id_token_token,_this._redirectUri,_this._state)}var cacheResult=_this.getCachedToken(authenticationRequest_1,userObject_1);if(cacheResult){if(cacheResult.token){_this._logger.info("Token is already in cache for scope:"+scope_1);resolve(cacheResult.token);return}else if(cacheResult.errorDesc||cacheResult.error){_this._logger.infoPii(cacheResult.errorDesc+":"+cacheResult.error);reject(cacheResult.errorDesc+Constants_1.Constants.resourceDelimeter+cacheResult.error);return}}else{_this._logger.verbose("Token is not in cache for scope:"+scope_1)}return newAuthority.ResolveEndpointsAsync().then(function(){if(window.activeRenewals[scope_1]){_this._logger.verbose("Renew token for scope: "+scope_1+" is in progress. Registering callback");_this.registerCallback(window.activeRenewals[scope_1],scope_1,resolve,reject)}else{if(scopes&&scopes.indexOf(_this.clientId)>-1&&scopes.length===1){_this._logger.verbose("renewing idToken");_this.renewIdToken(scopes,resolve,reject,userObject_1,authenticationRequest_1,extraQueryParameters)}else{_this._logger.verbose("renewing accesstoken");_this.renewToken(scopes,resolve,reject,userObject_1,authenticationRequest_1,extraQueryParameters)}}}).catch(function(err){_this._logger.warning("could not resolve endpoints");reject(err)})}})};UserAgentApplication.prototype.loadIframeTimeout=function(urlNavigate,frameName,scope){var _this=this;var expectedState=window.activeRenewals[scope];this._logger.verbose("Set loading state to pending for: "+scope+":"+expectedState);this._cacheStorage.setItem(Constants_1.Constants.renewStatus+expectedState,Constants_1.Constants.tokenRenewStatusInProgress);this.loadFrame(urlNavigate,frameName);setTimeout(function(){if(_this._cacheStorage.getItem(Constants_1.Constants.renewStatus+expectedState)===Constants_1.Constants.tokenRenewStatusInProgress){_this._logger.verbose("Loading frame has timed out after: "+_this.loadFrameTimeout/1e3+" seconds for scope "+scope+":"+expectedState);if(expectedState&&window.callBackMappedToRenewStates[expectedState]){window.callBackMappedToRenewStates[expectedState]("Token renewal operation failed due to timeout",null,"Token Renewal Failed",Constants_1.Constants.accessToken)}_this._cacheStorage.setItem(Constants_1.Constants.renewStatus+expectedState,Constants_1.Constants.tokenRenewStatusCancelled)}},this.loadFrameTimeout)};UserAgentApplication.prototype.loadFrame=function(urlNavigate,frameName){var _this=this;this._logger.info("LoadFrame: "+frameName);var frameCheck=frameName;setTimeout(function(){var frameHandle=_this.addAdalFrame(frameCheck);if(frameHandle.src===""||frameHandle.src==="about:blank"){frameHandle.src=urlNavigate;_this._logger.infoPii("Frame Name : "+frameName+" Navigated to: "+urlNavigate)}},500)};UserAgentApplication.prototype.addAdalFrame=function(iframeId){if(typeof iframeId==="undefined"){return null}this._logger.info("Add msal frame to document:"+iframeId);var adalFrame=document.getElementById(iframeId);if(!adalFrame){if(document.createElement&&document.documentElement&&window.navigator.userAgent.indexOf("MSIE 5.0")===-1){var ifr=document.createElement("iframe");ifr.setAttribute("id",iframeId);ifr.style.visibility="hidden";ifr.style.position="absolute";ifr.style.width=ifr.style.height="0";ifr.style.border="0";adalFrame=document.getElementsByTagName("body")[0].appendChild(ifr)}else if(document.body&&document.body.insertAdjacentHTML){document.body.insertAdjacentHTML("beforeend",'<iframe name="'+iframeId+'" id="'+iframeId+'" style="display:none"></iframe>')}if(window.frames&&window.frames[iframeId]){adalFrame=window.frames[iframeId]}}return adalFrame};UserAgentApplication.prototype.renewToken=function(scopes,resolve,reject,user,authenticationRequest,extraQueryParameters){var scope=scopes.join(" ").toLowerCase();this._logger.verbose("renewToken is called for scope:"+scope);var frameHandle=this.addAdalFrame("msalRenewFrame"+scope);if(extraQueryParameters){authenticationRequest.extraQueryParameters=extraQueryParameters}var acquireTokenUserKey;if(user){acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+user.userIdentifier+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}else{acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+Constants_1.Constants.no_user+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}if(Utils_1.Utils.isEmpty(this._cacheStorage.getItem(acquireTokenUserKey))){this._cacheStorage.setItem(acquireTokenUserKey,JSON.stringify(user))}var authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+authenticationRequest.state;if(Utils_1.Utils.isEmpty(this._cacheStorage.getItem(authorityKey))){this._cacheStorage.setItem(authorityKey,authenticationRequest.authority)}this._cacheStorage.setItem(Constants_1.Constants.nonceIdToken,authenticationRequest.nonce);this._logger.verbose("Renew token Expected state: "+authenticationRequest.state);var urlNavigate=authenticationRequest.createNavigateUrl(scopes)+Constants_1.Constants.prompt_none;urlNavigate=this.addHintParameters(urlNavigate,user);window.renewStates.push(authenticationRequest.state);window.requestType=Constants_1.Constants.renewToken;this.registerCallback(authenticationRequest.state,scope,resolve,reject);this._logger.infoPii("Navigate to:"+urlNavigate);frameHandle.src="about:blank";this.loadIframeTimeout(urlNavigate,"msalRenewFrame"+scope,scope)};UserAgentApplication.prototype.renewIdToken=function(scopes,resolve,reject,user,authenticationRequest,extraQueryParameters){var scope=scopes.join(" ").toLowerCase();this._logger.info("renewidToken is called");var frameHandle=this.addAdalFrame("msalIdTokenFrame");if(extraQueryParameters){authenticationRequest.extraQueryParameters=extraQueryParameters}var acquireTokenUserKey;if(user){acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+user.userIdentifier+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}else{acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+Constants_1.Constants.no_user+Constants_1.Constants.resourceDelimeter+authenticationRequest.state}if(Utils_1.Utils.isEmpty(this._cacheStorage.getItem(acquireTokenUserKey))){this._cacheStorage.setItem(acquireTokenUserKey,JSON.stringify(user))}var authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+authenticationRequest.state;if(Utils_1.Utils.isEmpty(this._cacheStorage.getItem(authorityKey))){this._cacheStorage.setItem(authorityKey,authenticationRequest.authority)}this._cacheStorage.setItem(Constants_1.Constants.nonceIdToken,authenticationRequest.nonce);this._logger.verbose("Renew Idtoken Expected state: "+authenticationRequest.state);var urlNavigate=authenticationRequest.createNavigateUrl(scopes)+Constants_1.Constants.prompt_none;urlNavigate=this.addHintParameters(urlNavigate,user);window.renewStates.push(authenticationRequest.state);window.requestType=Constants_1.Constants.renewToken;this.registerCallback(authenticationRequest.state,this.clientId,resolve,reject);this._logger.infoPii("Navigate to:"+urlNavigate);frameHandle.src="about:blank";this.loadIframeTimeout(urlNavigate,"msalIdTokenFrame",this.clientId)};UserAgentApplication.prototype.getUser=function(){if(this._user){return this._user}var rawIdToken=this._cacheStorage.getItem(Constants_1.Constants.idTokenKey);var rawClientInfo=this._cacheStorage.getItem(Constants_1.Constants.msalClientInfo);if(!Utils_1.Utils.isEmpty(rawIdToken)&&!Utils_1.Utils.isEmpty(rawClientInfo)){var idToken=new IdToken_1.IdToken(rawIdToken);var clientInfo=new ClientInfo_1.ClientInfo(rawClientInfo);this._user=User_1.User.createUser(idToken,clientInfo,this.authority);return this._user}return null};UserAgentApplication.prototype.handleAuthenticationResponse=function(hash){if(hash==null){hash=window.location.hash}var self=null;var isPopup=false;var isWindowOpenerMsal=false;try{isWindowOpenerMsal=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(err){isWindowOpenerMsal=false}if(isWindowOpenerMsal){self=window.opener.msal;isPopup=true}else if(window.parent&&window.parent.msal){self=window.parent.msal}var requestInfo=self.getRequestInfo(hash);var token=null,tokenReceivedCallback=null,tokenType,saveToken=true;self._logger.info("Returned from redirect url");if(window.parent!==window&&window.parent.msal){tokenReceivedCallback=window.parent.callBackMappedToRenewStates[requestInfo.stateResponse]}else if(isWindowOpenerMsal){tokenReceivedCallback=window.opener.callBackMappedToRenewStates[requestInfo.stateResponse]}else{if(self._navigateToLoginRequestUrl){tokenReceivedCallback=null;self._cacheStorage.setItem(Constants_1.Constants.urlHash,hash);saveToken=false;if(window.parent===window&&!isPopup){window.location.href=self._cacheStorage.getItem(Constants_1.Constants.loginRequest,this.storeAuthStateInCookie)}return}else{tokenReceivedCallback=self._tokenReceivedCallback;window.location.hash=""}}self.saveTokenFromHash(requestInfo);if(requestInfo.requestType===Constants_1.Constants.renewToken&&window.parent){if(window.parent!==window){self._logger.verbose("Window is in iframe, acquiring token silently")}else{self._logger.verbose("acquiring token interactive in progress")}token=requestInfo.parameters[Constants_1.Constants.accessToken]||requestInfo.parameters[Constants_1.Constants.idToken];tokenType=Constants_1.Constants.accessToken}else if(requestInfo.requestType===Constants_1.Constants.login){token=requestInfo.parameters[Constants_1.Constants.idToken];tokenType=Constants_1.Constants.idToken}var errorDesc=requestInfo.parameters[Constants_1.Constants.errorDescription];var error=requestInfo.parameters[Constants_1.Constants.error];try{if(tokenReceivedCallback){tokenReceivedCallback.call(self,errorDesc,token,error,tokenType,this.getUserState(this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)))}}catch(err){self._logger.error("Error occurred in token received callback function: "+err)}if(isWindowOpenerMsal){for(var i=0;i<window.opener.openedWindows.length;i++){window.opener.openedWindows[i].close()}}};UserAgentApplication.prototype.saveAccessToken=function(authority,tokenResponse,user,clientInfo,idToken){var scope;var clientObj=new ClientInfo_1.ClientInfo(clientInfo);if(tokenResponse.parameters.hasOwnProperty("scope")){scope=tokenResponse.parameters["scope"];var consentedScopes=scope.split(" ");var accessTokenCacheItems=this._cacheStorage.getAllAccessTokens(this.clientId,authority);for(var i=0;i<accessTokenCacheItems.length;i++){var accessTokenCacheItem=accessTokenCacheItems[i];if(accessTokenCacheItem.key.userIdentifier===user.userIdentifier){var cachedScopes=accessTokenCacheItem.key.scopes.split(" ");if(Utils_1.Utils.isIntersectingScopes(cachedScopes,consentedScopes)){this._cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key))}}}var accessTokenKey=new AccessTokenKey_1.AccessTokenKey(authority,this.clientId,scope,clientObj.uid,clientObj.utid);var accessTokenValue=new AccessTokenValue_1.AccessTokenValue(tokenResponse.parameters[Constants_1.Constants.accessToken],idToken.rawIdToken,Utils_1.Utils.expiresIn(tokenResponse.parameters[Constants_1.Constants.expiresIn]).toString(),clientInfo);this._cacheStorage.setItem(JSON.stringify(accessTokenKey),JSON.stringify(accessTokenValue))}else{scope=this.clientId;var accessTokenKey=new AccessTokenKey_1.AccessTokenKey(authority,this.clientId,scope,clientObj.uid,clientObj.utid);var accessTokenValue=new AccessTokenValue_1.AccessTokenValue(tokenResponse.parameters[Constants_1.Constants.idToken],tokenResponse.parameters[Constants_1.Constants.idToken],idToken.expiration,clientInfo);this._cacheStorage.setItem(JSON.stringify(accessTokenKey),JSON.stringify(accessTokenValue))}};UserAgentApplication.prototype.saveTokenFromHash=function(tokenResponse){this._logger.info("State status:"+tokenResponse.stateMatch+"; Request type:"+tokenResponse.requestType);this._cacheStorage.setItem(Constants_1.Constants.msalError,"");this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,"");var scope="";var authorityKey="";var acquireTokenUserKey="";if(tokenResponse.parameters.hasOwnProperty("scope")){scope=tokenResponse.parameters["scope"].toLowerCase()}else{scope=this.clientId}if(tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.errorDescription)||tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.error)){this._logger.infoPii("Error :"+tokenResponse.parameters[Constants_1.Constants.error]+"; Error description:"+tokenResponse.parameters[Constants_1.Constants.errorDescription]);this._cacheStorage.setItem(Constants_1.Constants.msalError,tokenResponse.parameters["error"]);this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,tokenResponse.parameters[Constants_1.Constants.errorDescription]);if(tokenResponse.requestType===Constants_1.Constants.login){this._loginInProgress=false;this._cacheStorage.setItem(Constants_1.Constants.loginError,tokenResponse.parameters[Constants_1.Constants.errorDescription]+":"+tokenResponse.parameters[Constants_1.Constants.error]);authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+tokenResponse.stateResponse}if(tokenResponse.requestType===Constants_1.Constants.renewToken){this._acquireTokenInProgress=false;authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+tokenResponse.stateResponse;var userKey=this.getUser()!==null?this.getUser().userIdentifier:"";acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+userKey+Constants_1.Constants.resourceDelimeter+tokenResponse.stateResponse}}else{if(tokenResponse.stateMatch){this._logger.info("State is right");if(tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.sessionState)){this._cacheStorage.setItem(Constants_1.Constants.msalSessionState,tokenResponse.parameters[Constants_1.Constants.sessionState])}var idToken;var clientInfo="";if(tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.accessToken)){this._logger.info("Fragment has access token");this._acquireTokenInProgress=false;var user=void 0;if(tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.idToken)){idToken=new IdToken_1.IdToken(tokenResponse.parameters[Constants_1.Constants.idToken])}else{idToken=new IdToken_1.IdToken(this._cacheStorage.getItem(Constants_1.Constants.idTokenKey))}authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+tokenResponse.stateResponse;var authority=void 0;if(!Utils_1.Utils.isEmpty(this._cacheStorage.getItem(authorityKey))){authority=this._cacheStorage.getItem(authorityKey);authority=Utils_1.Utils.replaceFirstPath(authority,idToken.tenantId)}if(tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.clientInfo)){clientInfo=tokenResponse.parameters[Constants_1.Constants.clientInfo];user=User_1.User.createUser(idToken,new ClientInfo_1.ClientInfo(clientInfo),authority)}else{this._logger.warning("ClientInfo not received in the response from AAD");user=User_1.User.createUser(idToken,new ClientInfo_1.ClientInfo(clientInfo),authority)}acquireTokenUserKey=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+user.userIdentifier+Constants_1.Constants.resourceDelimeter+tokenResponse.stateResponse;var acquireTokenUserKey_nouser=Constants_1.Constants.acquireTokenUser+Constants_1.Constants.resourceDelimeter+Constants_1.Constants.no_user+Constants_1.Constants.resourceDelimeter+tokenResponse.stateResponse;var acquireTokenUser=void 0;if(!Utils_1.Utils.isEmpty(this._cacheStorage.getItem(acquireTokenUserKey))){acquireTokenUser=JSON.parse(this._cacheStorage.getItem(acquireTokenUserKey));if(user&&acquireTokenUser&&Utils_1.Utils.compareObjects(user,acquireTokenUser)){this.saveAccessToken(authority,tokenResponse,user,clientInfo,idToken);this._logger.info("The user object received in the response is the same as the one passed in the acquireToken request")}else{this._logger.warning("The user object created from the response is not the same as the one passed in the acquireToken request")}}else if(!Utils_1.Utils.isEmpty(this._cacheStorage.getItem(acquireTokenUserKey_nouser))){this.saveAccessToken(authority,tokenResponse,user,clientInfo,idToken)}}if(tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.idToken)){this._logger.info("Fragment has id token");this._loginInProgress=false;idToken=new IdToken_1.IdToken(tokenResponse.parameters[Constants_1.Constants.idToken]);if(tokenResponse.parameters.hasOwnProperty(Constants_1.Constants.clientInfo)){clientInfo=tokenResponse.parameters[Constants_1.Constants.clientInfo]}else{this._logger.warning("ClientInfo not received in the response from AAD")}authorityKey=Constants_1.Constants.authority+Constants_1.Constants.resourceDelimeter+tokenResponse.stateResponse;var authority=void 0;if(!Utils_1.Utils.isEmpty(this._cacheStorage.getItem(authorityKey))){authority=this._cacheStorage.getItem(authorityKey);authority=Utils_1.Utils.replaceFirstPath(authority,idToken.tenantId)}this._user=User_1.User.createUser(idToken,new ClientInfo_1.ClientInfo(clientInfo),authority);if(idToken&&idToken.nonce){if(idToken.nonce!==this._cacheStorage.getItem(Constants_1.Constants.nonceIdToken,this.storeAuthStateInCookie)){this._user=null;this._cacheStorage.setItem(Constants_1.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this._cacheStorage.getItem(Constants_1.Constants.nonceIdToken)+","+"Actual Nonce: "+idToken.nonce);this._logger.error("Nonce Mismatch.Expected Nonce: "+this._cacheStorage.getItem(Constants_1.Constants.nonceIdToken)+","+"Actual Nonce: "+idToken.nonce)}else{this._cacheStorage.setItem(Constants_1.Constants.idTokenKey,tokenResponse.parameters[Constants_1.Constants.idToken]);this._cacheStorage.setItem(Constants_1.Constants.msalClientInfo,clientInfo);this.saveAccessToken(authority,tokenResponse,this._user,clientInfo,idToken)}}else{authorityKey=tokenResponse.stateResponse;acquireTokenUserKey=tokenResponse.stateResponse;this._logger.error("Invalid id_token received in the response");tokenResponse.parameters["error"]="invalid idToken";tokenResponse.parameters["error_description"]="Invalid idToken. idToken: "+tokenResponse.parameters[Constants_1.Constants.idToken];this._cacheStorage.setItem(Constants_1.Constants.msalError,"invalid idToken");this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,"Invalid idToken. idToken: "+tokenResponse.parameters[Constants_1.Constants.idToken])}}}else{authorityKey=tokenResponse.stateResponse;acquireTokenUserKey=tokenResponse.stateResponse;this._logger.error("State Mismatch.Expected State: "+this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)+","+"Actual State: "+tokenResponse.stateResponse);tokenResponse.parameters["error"]="Invalid_state";tokenResponse.parameters["error_description"]="Invalid_state. state: "+tokenResponse.stateResponse;this._cacheStorage.setItem(Constants_1.Constants.msalError,"Invalid_state");this._cacheStorage.setItem(Constants_1.Constants.msalErrorDescription,"Invalid_state. state: "+tokenResponse.stateResponse)}}this._cacheStorage.setItem(Constants_1.Constants.renewStatus+tokenResponse.stateResponse,Constants_1.Constants.tokenRenewStatusCompleted);this._cacheStorage.removeAcquireTokenEntries(authorityKey,acquireTokenUserKey);this._cacheStorage.clearCookie()};UserAgentApplication.prototype.isCallback=function(hash){hash=this.getHash(hash);var parameters=Utils_1.Utils.deserialize(hash);return parameters.hasOwnProperty(Constants_1.Constants.errorDescription)||parameters.hasOwnProperty(Constants_1.Constants.error)||parameters.hasOwnProperty(Constants_1.Constants.accessToken)||parameters.hasOwnProperty(Constants_1.Constants.idToken)};UserAgentApplication.prototype.getHash=function(hash){if(hash.indexOf("#/")>-1){hash=hash.substring(hash.indexOf("#/")+2)}else if(hash.indexOf("#")>-1){hash=hash.substring(1)}return hash};UserAgentApplication.prototype.getRequestInfo=function(hash){hash=this.getHash(hash);var parameters=Utils_1.Utils.deserialize(hash);var tokenResponse=new RequestInfo_1.TokenResponse;if(parameters){tokenResponse.parameters=parameters;if(parameters.hasOwnProperty(Constants_1.Constants.errorDescription)||parameters.hasOwnProperty(Constants_1.Constants.error)||parameters.hasOwnProperty(Constants_1.Constants.accessToken)||parameters.hasOwnProperty(Constants_1.Constants.idToken)){tokenResponse.valid=true;var stateResponse=void 0;if(parameters.hasOwnProperty("state")){stateResponse=parameters.state}else{return tokenResponse}tokenResponse.stateResponse=stateResponse;if(stateResponse===this._cacheStorage.getItem(Constants_1.Constants.stateLogin,this.storeAuthStateInCookie)){tokenResponse.requestType=Constants_1.Constants.login;tokenResponse.stateMatch=true;return tokenResponse}else if(stateResponse===this._cacheStorage.getItem(Constants_1.Constants.stateAcquireToken,this.storeAuthStateInCookie)){tokenResponse.requestType=Constants_1.Constants.renewToken;tokenResponse.stateMatch=true;return tokenResponse}if(!tokenResponse.stateMatch){tokenResponse.requestType=window.requestType;var statesInParentContext=window.renewStates;for(var i=0;i<statesInParentContext.length;i++){if(statesInParentContext[i]===tokenResponse.stateResponse){tokenResponse.stateMatch=true;break}}}}}return tokenResponse};UserAgentApplication.prototype.getScopeFromState=function(state){if(state){var splitIndex=state.indexOf("|");if(splitIndex>-1&&splitIndex+1<state.length){return state.substring(splitIndex+1)}}return""};UserAgentApplication.prototype.getUserState=function(state){if(state){var splitIndex=state.indexOf("|");if(splitIndex>-1&&splitIndex+1<state.length){return state.substring(splitIndex+1)}}return""};UserAgentApplication.prototype.isInIframe=function(){return window.parent!==window};UserAgentApplication.prototype.loginInProgress=function(){var pendingCallback=this._cacheStorage.getItem(Constants_1.Constants.urlHash);if(pendingCallback)return true;return this._loginInProgress};UserAgentApplication.prototype.getHostFromUri=function(uri){var extractedUri=String(uri).replace(/^(https?:)\/\//,"");extractedUri=extractedUri.split("/")[0];return extractedUri};UserAgentApplication.prototype.getScopesForEndpoint=function(endpoint){if(this._unprotectedResources.length>0){for(var i=0;i<this._unprotectedResources.length;i++){if(endpoint.indexOf(this._unprotectedResources[i])>-1){return null}}}if(this._protectedResourceMap.size>0){for(var _i=0,_a=Array.from(this._protectedResourceMap.keys());_i<_a.length;_i++){var key=_a[_i];if(endpoint.indexOf(key)>-1){return this._protectedResourceMap.get(key)}}}if(endpoint.indexOf("http://")>-1||endpoint.indexOf("https://")>-1){if(this.getHostFromUri(endpoint)===this.getHostFromUri(this._redirectUri)){return new Array(this.clientId)}}else{return new Array(this.clientId)}return null};UserAgentApplication.prototype.setloginInProgress=function(loginInProgress){this._loginInProgress=loginInProgress};UserAgentApplication.prototype.getAcquireTokenInProgress=function(){return this._acquireTokenInProgress};UserAgentApplication.prototype.setAcquireTokenInProgress=function(acquireTokenInProgress){this._acquireTokenInProgress=acquireTokenInProgress};UserAgentApplication.prototype.getLogger=function(){return this._logger};tslib_1.__decorate([resolveTokenOnlyIfOutOfIframe],UserAgentApplication.prototype,"acquireTokenSilent",null);return UserAgentApplication}();exports.UserAgentApplication=UserAgentApplication},{"./AccessTokenKey":26,"./AccessTokenValue":27,"./AuthenticationRequestParameters":28,"./AuthorityFactory":30,"./ClientInfo":32,"./Constants":33,"./IdToken":35,"./Logger":36,"./RequestInfo":37,"./Storage":38,"./User":39,"./Utils":41,tslib:44}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils=function(){function Utils(){}Utils.compareObjects=function(u1,u2){if(!u1||!u2){return false}if(u1.userIdentifier&&u2.userIdentifier){if(u1.userIdentifier===u2.userIdentifier){return true}}return false};Utils.expiresIn=function(expires){if(!expires){expires="3599"}return this.now()+parseInt(expires,10)};Utils.now=function(){return Math.round((new Date).getTime()/1e3)};Utils.isEmpty=function(str){return typeof str==="undefined"||!str||0===str.length};Utils.extractIdToken=function(encodedIdToken){var decodedToken=this.decodeJwt(encodedIdToken);if(!decodedToken){return null}try{var base64IdToken=decodedToken.JWSPayload;var base64Decoded=this.base64DecodeStringUrlSafe(base64IdToken);if(!base64Decoded){return null}return JSON.parse(base64Decoded)}catch(err){}return null};Utils.base64EncodeStringUrlSafe=function(input){if(window.btoa){return window.btoa(input)}else{return this.encode(input)}};Utils.base64DecodeStringUrlSafe=function(base64IdToken){base64IdToken=base64IdToken.replace(/-/g,"+").replace(/_/g,"/");if(window.atob){return decodeURIComponent(encodeURIComponent(window.atob(base64IdToken)))}else{return decodeURIComponent(encodeURIComponent(this.decode(base64IdToken)))}};Utils.encode=function(input){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=this.utf8Encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=(chr1&3)<<4|chr2>>4;enc3=(chr2&15)<<2|chr3>>6;enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else if(isNaN(chr3)){enc4=64}output=output+keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4)}return output.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};Utils.utf8Encode=function(input){input=input.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<input.length;n++){var c=input.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if(c>127&&c<2048){utftext+=String.fromCharCode(c>>6|192);utftext+=String.fromCharCode(c&63|128)}else{utftext+=String.fromCharCode(c>>12|224);utftext+=String.fromCharCode(c>>6&63|128);utftext+=String.fromCharCode(c&63|128)}}return utftext};Utils.decode=function(base64IdToken){var codes="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64IdToken=String(base64IdToken).replace(/=+$/,"");var length=base64IdToken.length;if(length%4===1){throw new Error("The token to be decoded is not correctly encoded.")}var h1,h2,h3,h4,bits,c1,c2,c3,decoded="";for(var i=0;i<length;i+=4){h1=codes.indexOf(base64IdToken.charAt(i));h2=codes.indexOf(base64IdToken.charAt(i+1));h3=codes.indexOf(base64IdToken.charAt(i+2));h4=codes.indexOf(base64IdToken.charAt(i+3));if(i+2===length-1){bits=h1<<18|h2<<12|h3<<6;c1=bits>>16&255;c2=bits>>8&255;decoded+=String.fromCharCode(c1,c2);break}else if(i+1===length-1){bits=h1<<18|h2<<12;c1=bits>>16&255;decoded+=String.fromCharCode(c1);break}bits=h1<<18|h2<<12|h3<<6|h4;c1=bits>>16&255;c2=bits>>8&255;c3=bits&255;decoded+=String.fromCharCode(c1,c2,c3)}return decoded};Utils.decodeJwt=function(jwtToken){if(this.isEmpty(jwtToken)){return null}var idTokenPartsRegex=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/;var matches=idTokenPartsRegex.exec(jwtToken);if(!matches||matches.length<4){return null}var crackedToken={header:matches[1],JWSPayload:matches[2],JWSSig:matches[3]};return crackedToken};Utils.deserialize=function(query){var match;var pl=/\+/g;var search=/([^&=]+)=([^&]*)/g;var decode=function(s){return decodeURIComponent(s.replace(pl," "))};var obj={};match=search.exec(query);while(match){obj[decode(match[1])]=decode(match[2]);match=search.exec(query)}return obj};Utils.isIntersectingScopes=function(cachedScopes,scopes){cachedScopes=this.convertToLowerCase(cachedScopes);for(var i=0;i<scopes.length;i++){if(cachedScopes.indexOf(scopes[i].toLowerCase())>-1){return true}}return false};Utils.containsScope=function(cachedScopes,scopes){cachedScopes=this.convertToLowerCase(cachedScopes);return scopes.every(function(value){return cachedScopes.indexOf(value.toString().toLowerCase())>=0})};Utils.convertToLowerCase=function(scopes){return scopes.map(function(scope){return scope.toLowerCase()})};Utils.removeElement=function(scopes,scope){return scopes.filter(function(value){return value!==scope})};Utils.decimalToHex=function(num){var hex=num.toString(16);while(hex.length<2){hex="0"+hex}return hex};Utils.getLibraryVersion=function(){return"0.2.3"};Utils.replaceFirstPath=function(href,tenantId){var match=href.match(/^(https?\:)\/\/(([^:\/?#] *)(?:\:([0-9]+))?)([\/]{0,1}[^?#] *)(\?[^#] *|)(#. *|)$/);if(match){var urlObject=Utils.GetUrlComponents(href);var pathArray=urlObject.PathSegments;pathArray.shift();if(pathArray[0]&&pathArray[0]==="common"||pathArray[0]==="organizations"){pathArray[0]=tenantId;href=urlObject.Protocol+"//"+urlObject.HostNameAndPort+"/"+pathArray.join("/")}}return href};Utils.createNewGuid=function(){var cryptoObj=window.crypto;if(cryptoObj&&cryptoObj.getRandomValues){var buffer=new Uint8Array(16);cryptoObj.getRandomValues(buffer);buffer[6]|=64;buffer[6]&=79;buffer[8]|=128;buffer[8]&=191;return Utils.decimalToHex(buffer[0])+Utils.decimalToHex(buffer[1])+Utils.decimalToHex(buffer[2])+Utils.decimalToHex(buffer[3])+"-"+Utils.decimalToHex(buffer[4])+Utils.decimalToHex(buffer[5])+"-"+Utils.decimalToHex(buffer[6])+Utils.decimalToHex(buffer[7])+"-"+Utils.decimalToHex(buffer[8])+Utils.decimalToHex(buffer[9])+"-"+Utils.decimalToHex(buffer[10])+Utils.decimalToHex(buffer[11])+Utils.decimalToHex(buffer[12])+Utils.decimalToHex(buffer[13])+Utils.decimalToHex(buffer[14])+Utils.decimalToHex(buffer[15])}else{var guidHolder="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";var hex="0123456789abcdef";var r=0;var guidResponse="";for(var i=0;i<36;i++){if(guidHolder[i]!=="-"&&guidHolder[i]!=="4"){r=Math.random()*16|0}if(guidHolder[i]==="x"){guidResponse+=hex[r]}else if(guidHolder[i]==="y"){r&=3;r|=8;guidResponse+=hex[r]}else{guidResponse+=guidHolder[i]}}return guidResponse}};Utils.GetUrlComponents=function(url){if(!url){throw"Url required"}var regEx=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");var match=url.match(regEx);if(!match||match.length<6){throw"Valid url required"}var urlComponents={Protocol:match[1],HostNameAndPort:match[4],AbsolutePath:match[5]};var pathSegments=urlComponents.AbsolutePath.split("/");pathSegments=pathSegments.filter(function(val){return val&&val.length>0});urlComponents.PathSegments=pathSegments;return urlComponents};Utils.CanonicalizeUri=function(url){if(url){url=url.toLowerCase()}if(url&&!Utils.endsWith(url,"/")){url+="/"}return url};Utils.endsWith=function(url,suffix){if(!url||!suffix){return false}return url.indexOf(suffix,url.length-suffix.length)!==-1};return Utils}();exports.Utils=Utils},{}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var XhrClient=function(){function XhrClient(){}XhrClient.prototype.sendRequestAsync=function(url,method,enableCaching){var _this=this;return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open(method,url,true);if(enableCaching){}xhr.onload=function(ev){if(xhr.status<200||xhr.status>=300){reject(_this.handleError(xhr.responseText))}try{var jsonResponse=JSON.parse(xhr.responseText)}catch(e){reject(_this.handleError(xhr.responseText))}resolve(jsonResponse)};xhr.onerror=function(ev){reject(xhr.status)};if(method==="GET"){xhr.send()}else{throw"not implemented"}})};XhrClient.prototype.handleError=function(responseText){var jsonResponse;try{jsonResponse=JSON.parse(responseText);if(jsonResponse.error){return jsonResponse.error}else{throw responseText}}catch(e){return responseText}};return XhrClient}();exports.XhrClient=XhrClient},{}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var UserAgentApplication_1=require("./UserAgentApplication");exports.UserAgentApplication=UserAgentApplication_1.UserAgentApplication;var Logger_1=require("./Logger");exports.Logger=Logger_1.Logger;var Logger_2=require("./Logger");exports.LogLevel=Logger_2.LogLevel;var User_1=require("./User");exports.User=User_1.User;var Constants_1=require("./Constants");exports.Constants=Constants_1.Constants;var RequestInfo_1=require("./RequestInfo");exports.TokenResponse=RequestInfo_1.TokenResponse;var Authority_1=require("./Authority");exports.Authority=Authority_1.Authority},{"./Authority":29,"./Constants":33,"./Logger":36,"./RequestInfo":37,"./User":39,"./UserAgentApplication":40}],44:[function(require,module,exports){(function(global){var __extends;var __assign;var __rest;var __decorate;var __param;var __metadata;var __awaiter;var __generator;var __exportStar;var __values;var __read;var __spread;var __await;var __asyncGenerator;var __asyncDelegator;var __asyncValues;(function(factory){var root=typeof global==="object"?global:typeof self==="object"?self:typeof this==="object"?this:{};if(typeof define==="function"&&define.amd){define("tslib",["exports"],function(exports){factory(createExporter(root,createExporter(exports)))})}else if(typeof module==="object"&&typeof module.exports==="object"){factory(createExporter(root,createExporter(module.exports)))}else{factory(createExporter(root))}function createExporter(exports,previous){return function(id,v){return exports[id]=previous?previous(id,v):v}}})(function(exporter){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};__extends=function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};__rest=function(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)if(e.indexOf(p[i])<0)t[p[i]]=s[p[i]];return t};__decorate=function(decorators,target,key,desc){var c=arguments.length,r=c<3?target:desc===null?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)if(d=decorators[i])r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r;return c>3&&r&&Object.defineProperty(target,key,r),r};__param=function(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}};__metadata=function(metadataKey,metadataValue){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(metadataKey,metadataValue)};__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};__generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};__exportStar=function(m,exports){for(var p in m)if(!exports.hasOwnProperty(p))exports[p]=m[p]};__values=function(o){var m=typeof Symbol==="function"&&o[Symbol.iterator],i=0;if(m)return m.call(o);return{next:function(){if(o&&i>=o.length)o=void 0;return{value:o&&o[i++],done:!o}}}};__read=function(o,n){var m=typeof Symbol==="function"&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),r,ar=[],e;try{while((n===void 0||n-- >0)&&!(r=i.next()).done)ar.push(r.value)}catch(error){e={error:error}}finally{try{if(r&&!r.done&&(m=i["return"]))m.call(i)}finally{if(e)throw e.error}}return ar};__spread=function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar};__await=function(v){return this instanceof __await?(this.v=v,this):new __await(v)};__asyncGenerator=function(thisArg,_arguments,generator){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=generator.apply(thisArg,_arguments||[]),i,q=[];return i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i;function verb(n){if(g[n])i[n]=function(v){return new Promise(function(a,b){q.push([n,v,a,b])>1||resume(n,v)})}}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume("next",value)}function reject(value){resume("throw",value)}function settle(f,v){if(f(v),q.shift(),q.length)resume(q[0][0],q[0][1])}};__asyncDelegator=function(o){var i,p;return i={},verb("next"),verb("throw",function(e){throw e}),verb("return"),i[Symbol.iterator]=function(){return this},i;function verb(n,f){if(o[n])i[n]=function(v){return(p=!p)?{value:__await(o[n](v)),done:n==="return"}:f?f(v):v}}};__asyncValues=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=o[Symbol.asyncIterator];return m?m.call(o):typeof __values==="function"?__values(o):o[Symbol.iterator]()};exporter("__extends",__extends);exporter("__assign",__assign);exporter("__rest",__rest);exporter("__decorate",__decorate);exporter("__param",__param);exporter("__metadata",__metadata);exporter("__awaiter",__awaiter);exporter("__generator",__generator);exporter("__exportStar",__exportStar);exporter("__values",__values);exporter("__read",__read);exporter("__spread",__spread);exporter("__await",__await);exporter("__asyncGenerator",__asyncGenerator);exporter("__asyncDelegator",__asyncDelegator);exporter("__asyncValues",__asyncValues)})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[1]);